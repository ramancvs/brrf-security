2018-02-22 20:16:28.671 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-22 20:16:28.709 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-22 20:16:28.709 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-22 20:16:28.709 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-22 20:16:28.710 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-22 20:16:28.924 +05:30 [DBG] Starting token cleanup
2018-02-22 20:16:39.409 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:16:44.371 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 20:16:46.840 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:16:46.842 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:16:46.850 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 20:16:46.868 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 20:16:46.868 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 20:16:46.875 +05:30 [DBG] Start discovery request
2018-02-22 20:16:48.569 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 20:16:48.708 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 20:16:49.701 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:16:49.701 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:16:49.704 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 20:16:49.704 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 20:16:49.705 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 20:16:49.711 +05:30 [DBG] Start key discovery request
2018-02-22 20:16:49.716 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:16:49.798 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-22 20:16:49.807 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-22 20:16:49.807 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-22 20:16:49.814 +05:30 [DBG] Start authorize request
2018-02-22 20:16:49.827 +05:30 [DBG] No user present in authorize request
2018-02-22 20:16:49.834 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:16:51.202 +05:30 [DBG] mvc found in database: true
2018-02-22 20:16:52.110 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:16:52.899 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:16:53.586 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:16:54.231 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:16:54.244 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:16:54.264 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "wHvL5KcguTPrmNlKfsoF8oF1FfEBoSfsNQu1I331",
  "Nonce": "wHvL5KcguTPrmNlKfsoF8oF1FfEBoSfsNQu1I331",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "wHvL5KcguTPrmNlKfsoF8oF1FfEBoSfsNQu1I331",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "wHvL5KcguTPrmNlKfsoF8oF1FfEBoSfsNQu1I331"
  }
}
2018-02-22 20:16:54.284 +05:30 [INF] Showing login: User is not authenticated
2018-02-22 20:16:54.404 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:16:55.262 +05:30 [DBG] mvc found in database: true
2018-02-22 20:16:56.025 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:16:56.695 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:16:57.332 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:16:57.621 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:16:57.621 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:16:57.914 +05:30 [DBG] mvc found in database: true
2018-02-22 20:16:59.728 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:17:09.907 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:17:13.759 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 20:17:13.770 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 20:17:13.773 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 20:17:13.777 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-22 20:17:13.780 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-22 20:17:13.871 +05:30 [DBG] Augmenting SignInContext
2018-02-22 20:17:13.874 +05:30 [DBG] Adding idp claim with value: local
2018-02-22 20:17:13.875 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-22 20:17:13.893 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 20:17:13.918 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:17:13.921 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:17:13.923 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-22 20:17:13.925 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-22 20:17:13.925 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-22 20:17:13.937 +05:30 [DBG] Start authorize callback request
2018-02-22 20:17:13.943 +05:30 [DBG] User in authorize request: 1
2018-02-22 20:17:13.943 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:17:21.334 +05:30 [DBG] mvc found in database: true
2018-02-22 20:21:56.015 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:21:59.847 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:22:10.045 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:22:11.224 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:22:19.910 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:22:20.753 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:22:28.288 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:22:42.037 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:22:42.038 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "wHvL5KcguTPrmNlKfsoF8oF1FfEBoSfsNQu1I331",
  "Nonce": "wHvL5KcguTPrmNlKfsoF8oF1FfEBoSfsNQu1I331",
  "SessionId": "050f800fb53c45922af6bc28f690207a",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "wHvL5KcguTPrmNlKfsoF8oF1FfEBoSfsNQu1I331",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "wHvL5KcguTPrmNlKfsoF8oF1FfEBoSfsNQu1I331"
  }
}
2018-02-22 20:22:42.042 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:22:59.133 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:23:12.772 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:23:12.781 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-22 20:23:12.790 +05:30 [DBG] Creating Implicit Flow response.
2018-02-22 20:23:12.803 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-22 20:23:12.804 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-22 20:23:23.193 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:23:35.679 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:23:41.339 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 20:23:41.430 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-22 20:23:49.914 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:23:50.612 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 20:23:50.628 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "wHvL5KcguTPrmNlKfsoF8oF1FfEBoSfsNQu1I331",
  "Scope": "openid profile"
}
2018-02-22 20:23:50.652 +05:30 [DBG] Augmenting SignInContext
2018-02-22 20:23:50.653 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 20:24:05.270 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:24:15.292 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:24:25.305 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:24:35.315 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:24:45.342 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:46:39.090 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-22 20:46:39.134 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-22 20:46:39.135 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-22 20:46:39.135 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-22 20:46:39.135 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-22 20:46:39.270 +05:30 [DBG] Starting token cleanup
2018-02-22 20:46:39.473 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 20:46:39.896 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:46:39.905 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:46:39.951 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 20:46:39.959 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 20:46:39.959 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 20:46:39.963 +05:30 [DBG] Start discovery request
2018-02-22 20:46:40.668 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 20:46:40.788 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 20:46:40.794 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:46:40.794 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:46:40.795 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 20:46:40.796 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 20:46:40.796 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 20:46:40.802 +05:30 [DBG] Start key discovery request
2018-02-22 20:46:40.887 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:46:40.891 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:46:40.895 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-22 20:46:40.909 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-22 20:46:40.909 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-22 20:46:40.917 +05:30 [DBG] Start authorize request
2018-02-22 20:46:40.938 +05:30 [DBG] User in authorize request: 1
2018-02-22 20:46:40.948 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:46:41.389 +05:30 [DBG] mvc found in database: true
2018-02-22 20:46:41.460 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:46:41.527 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:46:41.563 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:46:41.595 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:46:41.605 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:46:41.623 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "UNUtQ3Gp9gDm05X8LXFO9mDkrNaDhIEgbUpsDY9B",
  "Nonce": "UNUtQ3Gp9gDm05X8LXFO9mDkrNaDhIEgbUpsDY9B",
  "SessionId": "050f800fb53c45922af6bc28f690207a",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "UNUtQ3Gp9gDm05X8LXFO9mDkrNaDhIEgbUpsDY9B",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "UNUtQ3Gp9gDm05X8LXFO9mDkrNaDhIEgbUpsDY9B"
  }
}
2018-02-22 20:46:41.755 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-22 20:46:41.767 +05:30 [DBG] Creating Implicit Flow response.
2018-02-22 20:46:41.788 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-22 20:46:41.789 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-22 20:46:41.826 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 20:46:41.905 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-22 20:46:41.913 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 20:46:41.937 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "UNUtQ3Gp9gDm05X8LXFO9mDkrNaDhIEgbUpsDY9B",
  "Scope": "openid profile"
}
2018-02-22 20:46:41.973 +05:30 [DBG] Augmenting SignInContext
2018-02-22 20:46:41.989 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 20:46:43.730 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 20:46:43.736 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:46:43.737 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:46:43.737 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 20:46:43.737 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 20:46:43.737 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 20:46:43.737 +05:30 [DBG] Start discovery request
2018-02-22 20:46:43.761 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 20:46:43.862 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 20:46:43.866 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:46:43.866 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:46:43.866 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 20:46:43.867 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 20:46:43.867 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 20:46:43.867 +05:30 [DBG] Start key discovery request
2018-02-22 20:46:49.293 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:46:58.915 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 20:46:58.928 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:46:58.928 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:46:58.928 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 20:46:58.928 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 20:46:58.929 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 20:46:58.929 +05:30 [DBG] Start discovery request
2018-02-22 20:46:59.069 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 20:46:59.107 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 20:46:59.111 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:46:59.111 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:46:59.112 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 20:46:59.112 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 20:46:59.112 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 20:46:59.112 +05:30 [DBG] Start key discovery request
2018-02-22 20:46:59.312 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:46:59.534 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-22 20:46:59.535 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-22 20:46:59.535 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-22 20:46:59.535 +05:30 [DBG] Start authorize request
2018-02-22 20:46:59.536 +05:30 [DBG] No user present in authorize request
2018-02-22 20:46:59.536 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:46:59.592 +05:30 [DBG] mvc found in database: true
2018-02-22 20:46:59.602 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:46:59.609 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:46:59.614 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:46:59.617 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:46:59.617 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:46:59.617 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "sTWWv4uwejoOBGiFzDHjOnXbicVVxjMS6rEFHNfM",
  "Nonce": "sTWWv4uwejoOBGiFzDHjOnXbicVVxjMS6rEFHNfM",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "sTWWv4uwejoOBGiFzDHjOnXbicVVxjMS6rEFHNfM",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "sTWWv4uwejoOBGiFzDHjOnXbicVVxjMS6rEFHNfM"
  }
}
2018-02-22 20:46:59.617 +05:30 [INF] Showing login: User is not authenticated
2018-02-22 20:46:59.909 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:46:59.949 +05:30 [DBG] mvc found in database: true
2018-02-22 20:46:59.959 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:46:59.965 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:46:59.970 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:46:59.972 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:46:59.973 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:46:59.998 +05:30 [DBG] mvc found in database: true
2018-02-22 20:47:09.319 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:47:10.227 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 20:47:10.235 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 20:47:10.237 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 20:47:10.240 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-22 20:47:10.241 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-22 20:47:10.325 +05:30 [DBG] Augmenting SignInContext
2018-02-22 20:47:10.325 +05:30 [DBG] Adding idp claim with value: local
2018-02-22 20:47:10.325 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-22 20:47:10.326 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 20:47:10.342 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:47:10.342 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:47:10.343 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-22 20:47:10.351 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-22 20:47:10.351 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-22 20:47:10.370 +05:30 [DBG] Start authorize callback request
2018-02-22 20:47:10.377 +05:30 [DBG] User in authorize request: 1
2018-02-22 20:47:10.377 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:47:10.418 +05:30 [DBG] mvc found in database: true
2018-02-22 20:47:10.425 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:47:10.432 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:47:10.436 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:47:10.439 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:47:10.439 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:47:10.440 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "sTWWv4uwejoOBGiFzDHjOnXbicVVxjMS6rEFHNfM",
  "Nonce": "sTWWv4uwejoOBGiFzDHjOnXbicVVxjMS6rEFHNfM",
  "SessionId": "a0bd72a541f2d587a351612dec9012c5",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "sTWWv4uwejoOBGiFzDHjOnXbicVVxjMS6rEFHNfM",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "sTWWv4uwejoOBGiFzDHjOnXbicVVxjMS6rEFHNfM"
  }
}
2018-02-22 20:47:10.447 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-22 20:47:10.447 +05:30 [DBG] Creating Implicit Flow response.
2018-02-22 20:47:10.447 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-22 20:47:10.447 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-22 20:47:10.451 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 20:47:10.456 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-22 20:47:10.460 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 20:47:10.465 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "sTWWv4uwejoOBGiFzDHjOnXbicVVxjMS6rEFHNfM",
  "Scope": "openid profile"
}
2018-02-22 20:47:10.466 +05:30 [DBG] Augmenting SignInContext
2018-02-22 20:47:10.466 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 20:47:11.830 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 20:47:11.834 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:47:11.834 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:47:11.834 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 20:47:11.835 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 20:47:11.835 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 20:47:11.835 +05:30 [DBG] Start discovery request
2018-02-22 20:47:11.856 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 20:47:11.939 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 20:47:11.942 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:47:11.942 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:47:11.943 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 20:47:11.943 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 20:47:11.943 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 20:47:11.943 +05:30 [DBG] Start key discovery request
2018-02-22 20:47:19.333 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:47:29.343 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:47:39.347 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:47:49.361 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:47:59.375 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:48:09.390 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:48:19.405 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:48:29.411 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:50:25.027 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-22 20:50:25.085 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-22 20:50:25.085 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-22 20:50:25.085 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-22 20:50:25.085 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-22 20:50:25.279 +05:30 [DBG] Starting token cleanup
2018-02-22 20:51:01.116 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-22 20:51:01.187 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-22 20:51:01.187 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-22 20:51:01.188 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-22 20:51:01.188 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-22 20:51:01.523 +05:30 [DBG] Starting token cleanup
2018-02-22 20:51:01.932 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 20:51:02.913 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:51:02.925 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:51:03.038 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 20:51:03.059 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 20:51:03.060 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 20:51:03.067 +05:30 [DBG] Start discovery request
2018-02-22 20:51:04.093 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 20:51:04.222 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 20:51:04.233 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:51:04.233 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:51:04.234 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 20:51:04.235 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 20:51:04.235 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 20:51:04.240 +05:30 [DBG] Start key discovery request
2018-02-22 20:51:04.319 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-22 20:51:04.334 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-22 20:51:04.335 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-22 20:51:04.342 +05:30 [DBG] Start authorize request
2018-02-22 20:51:04.362 +05:30 [DBG] No user present in authorize request
2018-02-22 20:51:04.372 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:51:04.809 +05:30 [DBG] mvc found in database: true
2018-02-22 20:51:04.861 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:51:04.919 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:51:04.938 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:51:04.946 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:51:04.955 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:51:04.975 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "iJ9AxTC3XpfnzX2gI3pLRxYUKd7gEf3ECj9eXINI",
  "Nonce": "iJ9AxTC3XpfnzX2gI3pLRxYUKd7gEf3ECj9eXINI",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "iJ9AxTC3XpfnzX2gI3pLRxYUKd7gEf3ECj9eXINI",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "iJ9AxTC3XpfnzX2gI3pLRxYUKd7gEf3ECj9eXINI"
  }
}
2018-02-22 20:51:04.987 +05:30 [INF] Showing login: User is not authenticated
2018-02-22 20:51:05.177 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:51:05.222 +05:30 [DBG] mvc found in database: true
2018-02-22 20:51:05.229 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:51:05.235 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:51:05.238 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:51:05.241 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:51:05.241 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:51:05.265 +05:30 [DBG] mvc found in database: true
2018-02-22 20:51:11.552 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:51:21.565 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:51:29.938 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-22 20:51:29.973 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-22 20:51:29.973 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-22 20:51:29.973 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-22 20:51:29.973 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-22 20:51:30.148 +05:30 [DBG] Starting token cleanup
2018-02-22 20:51:39.353 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 20:51:41.784 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:51:41.793 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:51:41.799 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 20:51:41.812 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:51:41.816 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 20:51:41.817 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 20:51:41.823 +05:30 [DBG] Start discovery request
2018-02-22 20:51:43.402 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 20:51:43.504 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 20:51:44.216 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:51:44.216 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:51:44.219 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 20:51:44.220 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 20:51:44.220 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 20:51:44.229 +05:30 [DBG] Start key discovery request
2018-02-22 20:51:44.303 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-22 20:51:44.307 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-22 20:51:44.307 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-22 20:51:44.316 +05:30 [DBG] Start authorize request
2018-02-22 20:51:44.332 +05:30 [DBG] No user present in authorize request
2018-02-22 20:51:44.337 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:51:45.534 +05:30 [DBG] mvc found in database: true
2018-02-22 20:51:46.317 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:51:46.999 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:51:47.585 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:51:48.151 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:51:48.161 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:51:48.180 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "2l0NOfx18VEITHHuzyVthLgD8raGqgeCicqSKv7H",
  "Nonce": "2l0NOfx18VEITHHuzyVthLgD8raGqgeCicqSKv7H",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "2l0NOfx18VEITHHuzyVthLgD8raGqgeCicqSKv7H",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "2l0NOfx18VEITHHuzyVthLgD8raGqgeCicqSKv7H"
  }
}
2018-02-22 20:51:48.192 +05:30 [INF] Showing login: User is not authenticated
2018-02-22 20:51:48.289 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:51:49.049 +05:30 [DBG] mvc found in database: true
2018-02-22 20:51:49.761 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:51:50.328 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:51:50.946 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:51:51.553 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:51:51.554 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:51:52.234 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:51:52.331 +05:30 [DBG] mvc found in database: true
2018-02-22 20:52:01.340 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 20:52:01.348 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 20:52:01.353 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 20:52:01.358 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-22 20:52:01.361 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-22 20:52:01.443 +05:30 [DBG] Augmenting SignInContext
2018-02-22 20:52:01.446 +05:30 [DBG] Adding idp claim with value: local
2018-02-22 20:52:01.446 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-22 20:52:01.465 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 20:52:01.492 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:52:01.496 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:52:01.498 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-22 20:52:01.499 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-22 20:52:01.500 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-22 20:52:01.508 +05:30 [DBG] Start authorize callback request
2018-02-22 20:52:01.513 +05:30 [DBG] User in authorize request: 1
2018-02-22 20:52:01.513 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:52:02.199 +05:30 [DBG] mvc found in database: true
2018-02-22 20:52:02.850 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:52:02.861 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:52:03.659 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:52:04.250 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:52:04.807 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:52:04.807 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:52:04.808 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "2l0NOfx18VEITHHuzyVthLgD8raGqgeCicqSKv7H",
  "Nonce": "2l0NOfx18VEITHHuzyVthLgD8raGqgeCicqSKv7H",
  "SessionId": "d9885a27e0f07830bc4421bc468dca5e",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "2l0NOfx18VEITHHuzyVthLgD8raGqgeCicqSKv7H",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "2l0NOfx18VEITHHuzyVthLgD8raGqgeCicqSKv7H"
  }
}
2018-02-22 20:52:04.861 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-22 20:52:04.869 +05:30 [DBG] Creating Implicit Flow response.
2018-02-22 20:52:04.881 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-22 20:52:04.881 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-22 20:52:04.900 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 20:52:04.979 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-22 20:52:04.993 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 20:52:05.009 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "2l0NOfx18VEITHHuzyVthLgD8raGqgeCicqSKv7H",
  "Scope": "openid profile"
}
2018-02-22 20:52:05.031 +05:30 [DBG] Augmenting SignInContext
2018-02-22 20:52:05.032 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 20:52:06.026 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 20:52:07.195 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:52:07.195 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:52:07.201 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 20:52:07.203 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 20:52:07.203 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 20:52:07.209 +05:30 [DBG] Start discovery request
2018-02-22 20:52:07.811 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 20:52:07.843 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 20:52:08.438 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:52:08.439 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:52:08.443 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 20:52:08.443 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 20:52:08.443 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 20:52:08.447 +05:30 [DBG] Start key discovery request
2018-02-22 20:52:12.862 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:52:22.865 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:52:32.868 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:52:42.880 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:52:49.849 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:52:49.860 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:52:49.863 +05:30 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-02-22 20:52:49.867 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-02-22 20:52:49.867 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-02-22 20:52:49.878 +05:30 [DBG] Processing signout request for 1
2018-02-22 20:52:49.885 +05:30 [DBG] Start end session request validation
2018-02-22 20:52:49.897 +05:30 [INF] End session request validation success
{
  "SubjectId": "1",
  "Raw": {}
}
2018-02-22 20:52:49.899 +05:30 [DBG] Success validating end session request from null
2018-02-22 20:52:49.925 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:52:49.927 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:52:52.273 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:52:52.276 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:52:52.303 +05:30 [INF] AuthenticationScheme: idsrv signed out.
2018-02-22 20:52:52.512 +05:30 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-02-22 20:52:52.533 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-02-22 20:52:52.533 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-02-22 20:52:52.545 +05:30 [DBG] Processing signout callback request
2018-02-22 20:52:55.009 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:52:55.062 +05:30 [DBG] mvc found in database: true
2018-02-22 20:52:55.062 +05:30 [DBG] No client front-channel logout URLs
2018-02-22 20:52:55.062 +05:30 [DBG] No client back-channel logout URLs
2018-02-22 20:52:55.062 +05:30 [INF] Successful signout callback.
2018-02-22 20:52:55.064 +05:30 [DBG] No client front-channel iframe urls
2018-02-22 20:52:55.064 +05:30 [DBG] No client back-channel iframe urls
2018-02-22 20:53:05.021 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:53:15.046 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:53:25.063 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:53:35.070 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:53:45.087 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:53:55.098 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:54:05.103 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:54:15.112 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:54:17.769 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 20:54:19.138 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:54:19.138 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:54:19.140 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 20:54:19.140 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 20:54:19.140 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 20:54:19.142 +05:30 [DBG] Start discovery request
2018-02-22 20:54:19.614 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 20:54:19.627 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 20:54:20.112 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:54:20.112 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:54:20.115 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 20:54:20.116 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 20:54:20.116 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 20:54:20.118 +05:30 [DBG] Start key discovery request
2018-02-22 20:54:20.155 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-22 20:54:20.156 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-22 20:54:20.156 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-22 20:54:20.159 +05:30 [DBG] Start authorize request
2018-02-22 20:54:20.159 +05:30 [DBG] No user present in authorize request
2018-02-22 20:54:20.159 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:54:20.406 +05:30 [DBG] mvc found in database: true
2018-02-22 20:54:20.749 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:54:20.911 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:54:21.185 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:54:21.757 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:54:21.757 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:54:21.758 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "WJlc5yf4RkhH5LZZA4jMA6uK89ZEdWAuOmHidOUY",
  "Nonce": "WJlc5yf4RkhH5LZZA4jMA6uK89ZEdWAuOmHidOUY",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "WJlc5yf4RkhH5LZZA4jMA6uK89ZEdWAuOmHidOUY",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "WJlc5yf4RkhH5LZZA4jMA6uK89ZEdWAuOmHidOUY"
  }
}
2018-02-22 20:54:21.760 +05:30 [INF] Showing login: User is not authenticated
2018-02-22 20:54:21.788 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:54:22.343 +05:30 [DBG] mvc found in database: true
2018-02-22 20:54:22.778 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:54:23.024 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:54:23.210 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:54:23.416 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:54:23.416 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:54:23.707 +05:30 [DBG] mvc found in database: true
2018-02-22 20:54:25.138 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:54:31.279 +05:30 [DBG] Augmenting SignInContext
2018-02-22 20:54:31.279 +05:30 [DBG] Adding idp claim with value: local
2018-02-22 20:54:31.279 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-22 20:54:31.280 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 20:54:31.295 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:54:31.298 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:54:31.301 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-22 20:54:31.301 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-22 20:54:31.301 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-22 20:54:31.304 +05:30 [DBG] Start authorize callback request
2018-02-22 20:54:31.304 +05:30 [DBG] User in authorize request: 1
2018-02-22 20:54:31.304 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 20:54:31.970 +05:30 [DBG] mvc found in database: true
2018-02-22 20:54:32.572 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:54:33.080 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:54:33.317 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 20:54:33.519 +05:30 [DBG] Found [] API scopes in database
2018-02-22 20:54:33.519 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 20:54:33.519 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "WJlc5yf4RkhH5LZZA4jMA6uK89ZEdWAuOmHidOUY",
  "Nonce": "WJlc5yf4RkhH5LZZA4jMA6uK89ZEdWAuOmHidOUY",
  "SessionId": "93ff5a69442195bb27209f7881560240",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "WJlc5yf4RkhH5LZZA4jMA6uK89ZEdWAuOmHidOUY",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "WJlc5yf4RkhH5LZZA4jMA6uK89ZEdWAuOmHidOUY"
  }
}
2018-02-22 20:54:33.539 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-22 20:54:33.539 +05:30 [DBG] Creating Implicit Flow response.
2018-02-22 20:54:33.539 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-22 20:54:33.539 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-22 20:54:33.552 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 20:54:33.557 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-22 20:54:33.566 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 20:54:33.569 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "WJlc5yf4RkhH5LZZA4jMA6uK89ZEdWAuOmHidOUY",
  "Scope": "openid profile"
}
2018-02-22 20:54:33.571 +05:30 [DBG] Augmenting SignInContext
2018-02-22 20:54:33.573 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 20:54:34.465 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 20:54:35.244 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:54:35.245 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:54:35.248 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:54:35.252 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 20:54:35.253 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 20:54:35.253 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 20:54:35.255 +05:30 [DBG] Start discovery request
2018-02-22 20:54:35.541 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 20:54:35.632 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 20:54:36.279 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 20:54:36.280 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 20:54:36.286 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 20:54:36.288 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 20:54:36.288 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 20:54:36.293 +05:30 [DBG] Start key discovery request
2018-02-22 20:54:40.186 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:54:40.190 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:54:40.193 +05:30 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-02-22 20:54:40.194 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-02-22 20:54:40.194 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-02-22 20:54:40.202 +05:30 [DBG] Processing signout request for 1
2018-02-22 20:54:40.203 +05:30 [DBG] Start end session request validation
2018-02-22 20:54:40.203 +05:30 [INF] End session request validation success
{
  "SubjectId": "1",
  "Raw": {}
}
2018-02-22 20:54:40.206 +05:30 [DBG] Success validating end session request from null
2018-02-22 20:54:40.227 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:54:40.231 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 20:54:58.829 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:55:16.858 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:55:18.138 +05:30 [INF] AuthenticationScheme: idsrv signed out.
2018-02-22 20:55:24.784 +05:30 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-02-22 20:55:24.786 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-02-22 20:55:24.786 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-02-22 20:55:24.797 +05:30 [DBG] Processing signout callback request
2018-02-22 20:55:25.858 +05:30 [DBG] mvc found in database: true
2018-02-22 20:55:25.859 +05:30 [DBG] No client front-channel logout URLs
2018-02-22 20:55:25.859 +05:30 [DBG] No client back-channel logout URLs
2018-02-22 20:55:25.859 +05:30 [INF] Successful signout callback.
2018-02-22 20:55:25.861 +05:30 [DBG] No client front-channel iframe urls
2018-02-22 20:55:25.861 +05:30 [DBG] No client back-channel iframe urls
2018-02-22 20:55:27.209 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:55:37.216 +05:30 [INF] Clearing 0 tokens
2018-02-22 20:55:42.852 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 21:01:41.581 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:01:41.589 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:01:41.589 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:01:41.591 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 21:01:41.591 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 21:01:41.591 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 21:01:41.593 +05:30 [DBG] Start discovery request
2018-02-22 21:01:42.426 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 21:01:51.590 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:01:57.042 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 21:01:58.822 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:01:58.822 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:01:58.826 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 21:01:58.826 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 21:01:58.826 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 21:01:58.831 +05:30 [DBG] Start discovery request
2018-02-22 21:01:59.142 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 21:01:59.163 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 21:01:59.332 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:01:59.332 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:01:59.335 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 21:01:59.335 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 21:01:59.335 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 21:01:59.337 +05:30 [DBG] Start key discovery request
2018-02-22 21:01:59.372 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-22 21:01:59.373 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-22 21:01:59.373 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-22 21:01:59.375 +05:30 [DBG] Start authorize request
2018-02-22 21:01:59.375 +05:30 [DBG] No user present in authorize request
2018-02-22 21:01:59.375 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:01:59.633 +05:30 [DBG] mvc found in database: true
2018-02-22 21:01:59.961 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:02:00.160 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:02:00.330 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:02:00.498 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:02:00.498 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:02:00.498 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "CIAhnWpnkS4Ifgjy7hCLNDgRmCrbo8mGoXbofQVr",
  "Nonce": "CIAhnWpnkS4Ifgjy7hCLNDgRmCrbo8mGoXbofQVr",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "CIAhnWpnkS4Ifgjy7hCLNDgRmCrbo8mGoXbofQVr",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "CIAhnWpnkS4Ifgjy7hCLNDgRmCrbo8mGoXbofQVr"
  }
}
2018-02-22 21:02:00.502 +05:30 [INF] Showing login: User is not authenticated
2018-02-22 21:02:00.558 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:02:00.952 +05:30 [DBG] mvc found in database: true
2018-02-22 21:02:01.149 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:02:01.306 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:02:01.528 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:02:01.747 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:02:01.748 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:02:01.965 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:02:02.069 +05:30 [DBG] mvc found in database: true
2018-02-22 21:02:09.645 +05:30 [DBG] Augmenting SignInContext
2018-02-22 21:02:09.645 +05:30 [DBG] Adding idp claim with value: local
2018-02-22 21:02:09.645 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-22 21:02:09.646 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 21:02:09.661 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:02:09.665 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:02:09.667 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-22 21:02:09.667 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-22 21:02:09.668 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-22 21:02:09.669 +05:30 [DBG] Start authorize callback request
2018-02-22 21:02:09.670 +05:30 [DBG] User in authorize request: 1
2018-02-22 21:02:09.670 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:02:10.335 +05:30 [DBG] mvc found in database: true
2018-02-22 21:02:10.932 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:02:11.534 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:02:12.103 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:02:12.114 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:02:12.779 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:02:12.779 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:02:12.779 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "CIAhnWpnkS4Ifgjy7hCLNDgRmCrbo8mGoXbofQVr",
  "Nonce": "CIAhnWpnkS4Ifgjy7hCLNDgRmCrbo8mGoXbofQVr",
  "SessionId": "bd4a6b8209c188b30f4f3b4541d91847",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "CIAhnWpnkS4Ifgjy7hCLNDgRmCrbo8mGoXbofQVr",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "CIAhnWpnkS4Ifgjy7hCLNDgRmCrbo8mGoXbofQVr"
  }
}
2018-02-22 21:02:12.804 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-22 21:02:12.804 +05:30 [DBG] Creating Implicit Flow response.
2018-02-22 21:02:12.804 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-22 21:02:12.804 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-22 21:02:12.812 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 21:02:12.816 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-22 21:02:12.824 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 21:02:12.827 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "CIAhnWpnkS4Ifgjy7hCLNDgRmCrbo8mGoXbofQVr",
  "Scope": "openid profile"
}
2018-02-22 21:02:12.830 +05:30 [DBG] Augmenting SignInContext
2018-02-22 21:02:12.830 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 21:02:13.768 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 21:02:14.507 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:02:14.507 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:02:14.510 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 21:02:14.511 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 21:02:14.511 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 21:02:14.523 +05:30 [DBG] Start discovery request
2018-02-22 21:02:15.182 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 21:02:15.202 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 21:02:15.741 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:02:15.742 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:02:15.745 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 21:02:15.745 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 21:02:15.745 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 21:02:15.749 +05:30 [DBG] Start key discovery request
2018-02-22 21:02:22.104 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:02:32.118 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:02:42.140 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:02:52.163 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:03:02.180 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:03:12.203 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:03:22.211 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:03:32.249 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:03:42.265 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:03:52.273 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:04:02.287 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:04:12.291 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:04:22.297 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:04:32.301 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:04:42.309 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:04:52.323 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:05:02.335 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:05:12.357 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:05:22.390 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:05:32.432 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:05:42.453 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:05:52.464 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:06:02.513 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:06:12.533 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:06:22.579 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:06:32.592 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:06:42.612 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:06:52.629 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:07:02.629 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:07:12.644 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:07:22.646 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:07:32.656 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:07:42.671 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:07:52.681 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:08:02.691 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:08:12.703 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:08:22.721 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:08:32.794 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:08:33.572 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 21:08:37.361 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:08:37.361 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:08:37.363 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 21:08:37.363 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 21:08:37.363 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 21:08:37.365 +05:30 [DBG] Start discovery request
2018-02-22 21:08:37.604 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 21:08:37.617 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 21:08:37.943 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:08:37.943 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:08:37.946 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 21:08:37.947 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 21:08:37.947 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 21:08:37.953 +05:30 [DBG] Start key discovery request
2018-02-22 21:08:37.987 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-22 21:08:37.988 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-22 21:08:37.988 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-22 21:08:37.990 +05:30 [DBG] Start authorize request
2018-02-22 21:08:37.991 +05:30 [DBG] No user present in authorize request
2018-02-22 21:08:37.991 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:08:38.390 +05:30 [DBG] mvc found in database: true
2018-02-22 21:08:39.334 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:08:39.911 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:08:40.500 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:08:41.224 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:08:41.225 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:08:41.225 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "7QnbmgT1dMP85cgE66wVeNeJ8U41fxUaVwgP2BNC",
  "Nonce": "7QnbmgT1dMP85cgE66wVeNeJ8U41fxUaVwgP2BNC",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "7QnbmgT1dMP85cgE66wVeNeJ8U41fxUaVwgP2BNC",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "7QnbmgT1dMP85cgE66wVeNeJ8U41fxUaVwgP2BNC"
  }
}
2018-02-22 21:08:41.227 +05:30 [INF] Showing login: User is not authenticated
2018-02-22 21:08:41.256 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:08:41.939 +05:30 [DBG] mvc found in database: true
2018-02-22 21:08:42.587 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:08:42.845 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:08:43.059 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:08:43.256 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:08:43.265 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:08:43.266 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:08:43.569 +05:30 [DBG] mvc found in database: true
2018-02-22 21:08:53.491 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:09:05.638 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:09:31.981 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:09:35.587 +05:30 [DBG] Augmenting SignInContext
2018-02-22 21:09:35.587 +05:30 [DBG] Adding idp claim with value: local
2018-02-22 21:09:35.588 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-22 21:09:35.588 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 21:09:42.397 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:09:42.421 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:09:42.423 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:09:42.425 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-22 21:09:42.426 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-22 21:09:42.426 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-22 21:09:42.432 +05:30 [DBG] Start authorize callback request
2018-02-22 21:09:42.432 +05:30 [DBG] User in authorize request: 1
2018-02-22 21:09:42.432 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:09:48.218 +05:30 [DBG] mvc found in database: true
2018-02-22 21:09:55.065 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:09:58.284 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:10:08.719 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:10:09.391 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:10:12.911 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:10:16.856 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:10:17.506 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:10:17.506 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "7QnbmgT1dMP85cgE66wVeNeJ8U41fxUaVwgP2BNC",
  "Nonce": "7QnbmgT1dMP85cgE66wVeNeJ8U41fxUaVwgP2BNC",
  "SessionId": "ea78258f35d5b7f559766971ffe43273",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "7QnbmgT1dMP85cgE66wVeNeJ8U41fxUaVwgP2BNC",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "7QnbmgT1dMP85cgE66wVeNeJ8U41fxUaVwgP2BNC"
  }
}
2018-02-22 21:10:19.177 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-22 21:10:19.177 +05:30 [DBG] Creating Implicit Flow response.
2018-02-22 21:10:19.177 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-22 21:10:19.178 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-22 21:10:20.420 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:10:56.819 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 21:10:56.825 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-22 21:11:00.970 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:11:09.550 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 21:11:09.556 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "7QnbmgT1dMP85cgE66wVeNeJ8U41fxUaVwgP2BNC",
  "Scope": "openid profile"
}
2018-02-22 21:11:09.558 +05:30 [DBG] Augmenting SignInContext
2018-02-22 21:11:09.559 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 21:11:10.414 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 21:11:12.822 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:11:18.081 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:11:19.040 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:11:19.044 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 21:11:27.390 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 21:11:28.888 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 21:11:28.892 +05:30 [DBG] Start discovery request
2018-02-22 21:11:31.893 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:11:31.966 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 21:11:31.981 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 21:11:33.056 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:11:33.056 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:11:33.058 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 21:11:33.058 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 21:11:33.058 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 21:11:33.060 +05:30 [DBG] Start key discovery request
2018-02-22 21:11:41.957 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:11:51.964 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:12:01.983 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:12:11.996 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:12:22.015 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:12:32.028 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:12:42.063 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:12:52.073 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:13:02.094 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:15:28.179 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-22 21:15:28.221 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-22 21:15:28.221 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-22 21:15:28.221 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-22 21:15:28.221 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-22 21:15:28.404 +05:30 [DBG] Starting token cleanup
2018-02-22 21:15:28.642 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:15:28.670 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:15:31.960 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:15:31.973 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:15:38.842 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:15:48.869 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:15:58.891 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:15:59.860 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 21:16:00.094 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:16:00.095 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:16:00.101 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 21:16:00.113 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 21:16:00.113 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 21:16:00.122 +05:30 [DBG] Start discovery request
2018-02-22 21:16:01.197 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 21:16:02.840 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 21:16:02.851 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:16:02.852 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:16:02.860 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 21:16:02.861 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 21:16:02.861 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 21:16:02.875 +05:30 [DBG] Start key discovery request
2018-02-22 21:16:03.219 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-22 21:16:03.224 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-22 21:16:03.224 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-22 21:16:03.231 +05:30 [DBG] Start authorize request
2018-02-22 21:16:03.245 +05:30 [DBG] No user present in authorize request
2018-02-22 21:16:03.252 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:16:03.776 +05:30 [DBG] mvc found in database: true
2018-02-22 21:16:03.843 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:16:03.979 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:16:04.006 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:16:04.010 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:16:04.020 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:16:04.042 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "0847TqQmenl8U2EdaVzdyf7OKT14WauIhcK5EzMK",
  "Nonce": "0847TqQmenl8U2EdaVzdyf7OKT14WauIhcK5EzMK",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "0847TqQmenl8U2EdaVzdyf7OKT14WauIhcK5EzMK",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "0847TqQmenl8U2EdaVzdyf7OKT14WauIhcK5EzMK"
  }
}
2018-02-22 21:16:04.059 +05:30 [INF] Showing login: User is not authenticated
2018-02-22 21:16:04.346 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:16:04.404 +05:30 [DBG] mvc found in database: true
2018-02-22 21:16:04.430 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:16:04.458 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:16:04.505 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:16:04.521 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:16:04.522 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:16:04.731 +05:30 [DBG] mvc found in database: true
2018-02-22 21:16:08.924 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:16:11.423 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 21:16:11.431 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 21:16:11.438 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 21:16:11.442 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-22 21:16:11.445 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-22 21:16:11.556 +05:30 [DBG] Augmenting SignInContext
2018-02-22 21:16:11.559 +05:30 [DBG] Adding idp claim with value: local
2018-02-22 21:16:11.559 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-22 21:16:11.575 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 21:16:11.837 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:16:11.839 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:16:11.842 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-22 21:16:11.843 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-22 21:16:11.843 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-22 21:16:11.858 +05:30 [DBG] Start authorize callback request
2018-02-22 21:16:11.870 +05:30 [DBG] User in authorize request: 1
2018-02-22 21:16:11.870 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:16:11.938 +05:30 [DBG] mvc found in database: true
2018-02-22 21:16:11.947 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:16:11.952 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:16:11.959 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:16:11.963 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:16:11.964 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:16:11.964 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "0847TqQmenl8U2EdaVzdyf7OKT14WauIhcK5EzMK",
  "Nonce": "0847TqQmenl8U2EdaVzdyf7OKT14WauIhcK5EzMK",
  "SessionId": "bfeb3dc665868159b885c0efa523ca51",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "0847TqQmenl8U2EdaVzdyf7OKT14WauIhcK5EzMK",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "0847TqQmenl8U2EdaVzdyf7OKT14WauIhcK5EzMK"
  }
}
2018-02-22 21:16:12.020 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-22 21:16:12.032 +05:30 [DBG] Creating Implicit Flow response.
2018-02-22 21:16:12.051 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-22 21:16:12.052 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-22 21:16:12.072 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 21:16:12.184 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-22 21:16:12.214 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-22 21:16:12.236 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "0847TqQmenl8U2EdaVzdyf7OKT14WauIhcK5EzMK",
  "Scope": "openid profile"
}
2018-02-22 21:16:12.275 +05:30 [DBG] Augmenting SignInContext
2018-02-22 21:16:12.276 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 21:16:18.944 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:16:20.303 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 21:16:20.311 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:16:20.312 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:16:20.315 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 21:16:20.316 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 21:16:20.316 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 21:16:20.318 +05:30 [DBG] Start discovery request
2018-02-22 21:16:20.394 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 21:16:20.685 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 21:16:20.691 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:16:20.691 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:16:20.693 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 21:16:20.694 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 21:16:20.694 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 21:16:20.697 +05:30 [DBG] Start key discovery request
2018-02-22 21:16:29.000 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:16:39.009 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:16:49.023 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:16:59.030 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:17:09.027 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:17:19.050 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:18:03.145 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-22 21:18:03.183 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-22 21:18:03.183 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-22 21:18:03.183 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-22 21:18:03.183 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-22 21:18:03.385 +05:30 [DBG] Starting token cleanup
2018-02-22 21:18:03.589 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:18:03.610 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:18:07.025 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:18:07.030 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:18:13.834 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:18:19.920 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:18:19.931 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:18:19.945 +05:30 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-02-22 21:18:19.962 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-02-22 21:18:19.962 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-02-22 21:18:19.978 +05:30 [DBG] Processing signout request for 1
2018-02-22 21:18:19.986 +05:30 [DBG] Start end session request validation
2018-02-22 21:18:20.113 +05:30 [INF] End session request validation success
{
  "SubjectId": "1",
  "Raw": {}
}
2018-02-22 21:18:20.119 +05:30 [DBG] Success validating end session request from null
2018-02-22 21:18:20.198 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:18:20.201 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:18:22.344 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:18:22.347 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:18:22.411 +05:30 [INF] AuthenticationScheme: idsrv signed out.
2018-02-22 21:18:22.635 +05:30 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-02-22 21:18:22.700 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-02-22 21:18:22.700 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-02-22 21:18:22.723 +05:30 [DBG] Processing signout callback request
2018-02-22 21:18:23.838 +05:30 [DBG] mvc found in database: true
2018-02-22 21:18:23.838 +05:30 [DBG] No client front-channel logout URLs
2018-02-22 21:18:23.838 +05:30 [DBG] No client back-channel logout URLs
2018-02-22 21:18:23.838 +05:30 [INF] Successful signout callback.
2018-02-22 21:18:23.869 +05:30 [DBG] No client front-channel iframe urls
2018-02-22 21:18:23.871 +05:30 [DBG] No client back-channel iframe urls
2018-02-22 21:18:23.877 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:18:33.890 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:18:36.053 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 21:18:36.120 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:18:36.120 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:18:36.125 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 21:18:36.129 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 21:18:36.129 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 21:18:36.136 +05:30 [DBG] Start discovery request
2018-02-22 21:18:36.814 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 21:18:38.477 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 21:18:38.484 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:18:38.484 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:18:38.487 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 21:18:38.488 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 21:18:38.488 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 21:18:38.496 +05:30 [DBG] Start key discovery request
2018-02-22 21:18:38.779 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-22 21:18:38.785 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-22 21:18:38.786 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-22 21:18:38.798 +05:30 [DBG] Start authorize request
2018-02-22 21:18:38.805 +05:30 [DBG] No user present in authorize request
2018-02-22 21:18:38.811 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:18:38.922 +05:30 [DBG] mvc found in database: true
2018-02-22 21:18:38.990 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:18:39.051 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:18:39.074 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:18:39.094 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:18:39.105 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:18:39.129 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "s3tx8phhLOnOWf8zpZY6vVj9g2R3v4GpDWuiETfx",
  "Nonce": "s3tx8phhLOnOWf8zpZY6vVj9g2R3v4GpDWuiETfx",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "s3tx8phhLOnOWf8zpZY6vVj9g2R3v4GpDWuiETfx",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "s3tx8phhLOnOWf8zpZY6vVj9g2R3v4GpDWuiETfx"
  }
}
2018-02-22 21:18:39.144 +05:30 [INF] Showing login: User is not authenticated
2018-02-22 21:18:39.564 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:18:39.623 +05:30 [DBG] mvc found in database: true
2018-02-22 21:18:39.664 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:18:39.673 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:18:39.681 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:18:39.685 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:18:39.685 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:18:39.743 +05:30 [DBG] mvc found in database: true
2018-02-22 21:18:43.907 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:18:46.257 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 21:18:46.270 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 21:18:46.277 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-22 21:18:46.283 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-22 21:18:46.289 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-22 21:18:46.427 +05:30 [DBG] Augmenting SignInContext
2018-02-22 21:18:46.431 +05:30 [DBG] Adding idp claim with value: local
2018-02-22 21:18:46.431 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-22 21:18:46.443 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 21:18:46.497 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:18:46.501 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:18:46.505 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-22 21:18:46.507 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-22 21:18:46.507 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-22 21:18:46.521 +05:30 [DBG] Start authorize callback request
2018-02-22 21:18:46.528 +05:30 [DBG] User in authorize request: 1
2018-02-22 21:18:46.528 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:18:46.619 +05:30 [DBG] mvc found in database: true
2018-02-22 21:18:46.636 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:18:46.648 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:18:46.663 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:18:46.672 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:18:46.672 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:18:46.672 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "s3tx8phhLOnOWf8zpZY6vVj9g2R3v4GpDWuiETfx",
  "Nonce": "s3tx8phhLOnOWf8zpZY6vVj9g2R3v4GpDWuiETfx",
  "SessionId": "accc94a24c12deadc56896c736a87e6e",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "s3tx8phhLOnOWf8zpZY6vVj9g2R3v4GpDWuiETfx",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "s3tx8phhLOnOWf8zpZY6vVj9g2R3v4GpDWuiETfx"
  }
}
2018-02-22 21:18:46.730 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-22 21:18:46.742 +05:30 [DBG] Creating Implicit Flow response.
2018-02-22 21:18:46.758 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-22 21:18:46.759 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-22 21:18:47.098 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-22 21:18:47.187 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "s3tx8phhLOnOWf8zpZY6vVj9g2R3v4GpDWuiETfx",
  "Scope": "openid profile"
}
2018-02-22 21:18:47.205 +05:30 [DBG] Augmenting SignInContext
2018-02-22 21:18:47.206 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 21:18:50.123 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 21:18:50.134 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:18:50.134 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:18:50.139 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 21:18:50.140 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 21:18:50.140 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 21:18:50.151 +05:30 [DBG] Start discovery request
2018-02-22 21:18:50.201 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 21:18:50.258 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 21:18:50.269 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:18:50.270 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:18:50.274 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 21:18:50.275 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 21:18:50.275 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 21:18:50.278 +05:30 [DBG] Start key discovery request
2018-02-22 21:18:53.939 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:19:03.959 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:19:13.970 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:19:23.986 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:19:34.001 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:19:44.017 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:19:54.032 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:19:55.454 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:19:55.458 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:19:55.460 +05:30 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-02-22 21:19:55.461 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-02-22 21:19:55.461 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-02-22 21:19:55.469 +05:30 [DBG] Processing signout request for 1
2018-02-22 21:19:55.469 +05:30 [DBG] Start end session request validation
2018-02-22 21:19:55.470 +05:30 [INF] End session request validation success
{
  "SubjectId": "1",
  "Raw": {}
}
2018-02-22 21:19:55.472 +05:30 [DBG] Success validating end session request from null
2018-02-22 21:19:55.503 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:19:55.506 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:19:56.847 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:19:56.850 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:19:56.857 +05:30 [INF] AuthenticationScheme: idsrv signed out.
2018-02-22 21:19:56.946 +05:30 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-02-22 21:19:56.948 +05:30 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-02-22 21:19:56.948 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-02-22 21:19:56.996 +05:30 [DBG] Processing signout callback request
2018-02-22 21:19:57.102 +05:30 [DBG] mvc found in database: true
2018-02-22 21:19:57.103 +05:30 [DBG] No client front-channel logout URLs
2018-02-22 21:19:57.103 +05:30 [DBG] No client back-channel logout URLs
2018-02-22 21:19:57.103 +05:30 [INF] Successful signout callback.
2018-02-22 21:19:57.104 +05:30 [DBG] No client front-channel iframe urls
2018-02-22 21:19:57.105 +05:30 [DBG] No client back-channel iframe urls
2018-02-22 21:20:04.073 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:20:10.612 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-22 21:20:10.634 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:20:10.634 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:20:10.637 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-22 21:20:10.637 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-22 21:20:10.637 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-22 21:20:10.639 +05:30 [DBG] Start discovery request
2018-02-22 21:20:10.678 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-22 21:20:10.978 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-22 21:20:10.991 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-22 21:20:10.991 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-22 21:20:10.994 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-22 21:20:10.994 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-22 21:20:10.994 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-22 21:20:10.996 +05:30 [DBG] Start key discovery request
2018-02-22 21:20:13.507 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-22 21:20:13.509 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-22 21:20:13.509 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-22 21:20:13.518 +05:30 [DBG] Start authorize request
2018-02-22 21:20:13.519 +05:30 [DBG] No user present in authorize request
2018-02-22 21:20:13.519 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:20:13.634 +05:30 [DBG] mvc found in database: true
2018-02-22 21:20:13.645 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:20:13.668 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:20:13.686 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:20:13.690 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:20:13.690 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:20:13.690 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "PKHKIn22Y0IhK7hcJdvT7dSrcRocwVNBlCF1WEGf",
  "Nonce": "PKHKIn22Y0IhK7hcJdvT7dSrcRocwVNBlCF1WEGf",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "PKHKIn22Y0IhK7hcJdvT7dSrcRocwVNBlCF1WEGf",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "PKHKIn22Y0IhK7hcJdvT7dSrcRocwVNBlCF1WEGf"
  }
}
2018-02-22 21:20:13.693 +05:30 [INF] Showing login: User is not authenticated
2018-02-22 21:20:14.101 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:20:14.138 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:20:14.228 +05:30 [DBG] mvc found in database: true
2018-02-22 21:20:14.253 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:20:14.261 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:20:14.278 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:20:14.293 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:20:14.294 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:20:14.355 +05:30 [DBG] mvc found in database: true
2018-02-22 21:20:20.200 +05:30 [DBG] Augmenting SignInContext
2018-02-22 21:20:20.200 +05:30 [DBG] Adding idp claim with value: local
2018-02-22 21:20:20.200 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-22 21:20:20.201 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-22 21:20:20.288 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:20:20.291 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-22 21:20:20.303 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-22 21:20:20.304 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-22 21:20:20.304 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-22 21:20:20.308 +05:30 [DBG] Start authorize callback request
2018-02-22 21:20:20.309 +05:30 [DBG] User in authorize request: 1
2018-02-22 21:20:20.309 +05:30 [DBG] Start authorize request protocol validation
2018-02-22 21:20:20.377 +05:30 [DBG] mvc found in database: true
2018-02-22 21:20:20.388 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:20:20.393 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:20:20.406 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-22 21:20:20.411 +05:30 [DBG] Found [] API scopes in database
2018-02-22 21:20:20.412 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-22 21:20:20.412 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "PKHKIn22Y0IhK7hcJdvT7dSrcRocwVNBlCF1WEGf",
  "Nonce": "PKHKIn22Y0IhK7hcJdvT7dSrcRocwVNBlCF1WEGf",
  "SessionId": "d032527806bc8273439e67fac7a8d38e",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "PKHKIn22Y0IhK7hcJdvT7dSrcRocwVNBlCF1WEGf",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "PKHKIn22Y0IhK7hcJdvT7dSrcRocwVNBlCF1WEGf"
  }
}
2018-02-22 21:20:20.433 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-22 21:20:20.433 +05:30 [DBG] Creating Implicit Flow response.
2018-02-22 21:20:20.433 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-22 21:20:20.433 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-22 21:20:30.505 +05:30 [INF] Clearing 0 tokens
2018-02-22 21:20:54.121 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-22 21:20:54.122 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:30:26.444 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-23 14:30:26.581 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-23 14:30:26.581 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-23 14:30:26.581 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-23 14:30:26.581 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-23 14:30:26.912 +05:30 [DBG] Starting token cleanup
2018-02-23 14:30:27.081 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:27.101 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:31.927 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:31.927 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:31.961 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:31.961 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:31.964 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:31.964 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:31.991 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:31.992 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:32.008 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:32.008 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:32.491 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:32.491 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:32.613 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:32.613 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:32.849 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:32.850 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:49.093 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-23 14:30:49.136 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-23 14:30:49.137 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-23 14:30:49.137 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-23 14:30:49.137 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-23 14:30:49.342 +05:30 [DBG] Starting token cleanup
2018-02-23 14:30:49.825 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:49.852 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:54.007 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:54.019 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:30:59.844 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:31:04.086 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:31:04.089 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:31:09.880 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:31:19.901 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:31:29.914 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:31:39.940 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:31:49.952 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:31:59.964 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:32:09.974 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:32:19.995 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:32:30.020 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:32:40.020 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:32:50.028 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:33:00.041 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:33:01.347 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:33:01.350 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:33:01.732 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:33:01.741 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:33:01.745 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:33:01.750 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-23 14:33:01.753 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-23 14:33:01.886 +05:30 [DBG] Augmenting SignInContext
2018-02-23 14:33:01.890 +05:30 [DBG] Adding idp claim with value: local
2018-02-23 14:33:01.890 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-23 14:33:01.916 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 14:33:01.954 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:33:01.957 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:33:08.189 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:33:08.193 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:33:09.990 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:33:09.992 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:33:10.025 +05:30 [INF] AuthenticationScheme: idsrv signed out.
2018-02-23 14:33:10.052 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:33:20.069 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:33:30.083 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:33:40.101 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:33:50.105 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:34:00.113 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:34:10.116 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:34:20.131 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:34:30.145 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:34:40.501 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:34:50.542 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:35:00.562 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:35:10.574 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:35:20.585 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:35:30.589 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:35:40.598 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:35:50.608 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:36:00.612 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:36:10.626 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:36:20.649 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:36:30.656 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:36:40.677 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:36:50.704 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:37:00.717 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:37:10.735 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:37:20.749 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:37:30.755 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:37:32.767 +05:30 [DBG] Augmenting SignInContext
2018-02-23 14:37:32.767 +05:30 [DBG] Adding idp claim with value: local
2018-02-23 14:37:32.768 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-23 14:37:32.769 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 14:37:32.790 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:37:32.794 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:37:40.768 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:37:50.780 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:38:00.791 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:38:10.802 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:38:20.814 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:38:30.825 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:38:40.843 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:40:27.642 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-23 14:40:27.685 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-23 14:40:27.685 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-23 14:40:27.685 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-23 14:40:27.685 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-23 14:40:27.894 +05:30 [DBG] Starting token cleanup
2018-02-23 14:40:28.134 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:40:28.158 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:40:38.398 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:40:48.439 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:40:49.907 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 14:40:50.281 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:40:50.282 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:40:50.289 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 14:40:50.303 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 14:40:50.303 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 14:40:50.316 +05:30 [DBG] Start discovery request
2018-02-23 14:40:51.513 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 14:40:51.651 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 14:40:51.662 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:40:51.662 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:40:51.664 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 14:40:51.665 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 14:40:51.665 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 14:40:51.673 +05:30 [DBG] Start key discovery request
2018-02-23 14:40:51.750 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:40:51.753 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:40:51.756 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 14:40:51.764 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 14:40:51.764 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 14:40:51.773 +05:30 [DBG] Start authorize request
2018-02-23 14:40:51.786 +05:30 [DBG] User in authorize request: 88421113
2018-02-23 14:40:51.792 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:40:52.304 +05:30 [DBG] mvc found in database: true
2018-02-23 14:40:52.375 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:40:52.443 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:40:52.468 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:40:52.477 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:40:52.490 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:40:52.521 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "88421113",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "LwDGJEykY73JdjJyatLGMYacgEkO46SMr4Q4fibN",
  "Nonce": "LwDGJEykY73JdjJyatLGMYacgEkO46SMr4Q4fibN",
  "SessionId": "4db8f95e97486b092fa22579453219d2",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "LwDGJEykY73JdjJyatLGMYacgEkO46SMr4Q4fibN",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "LwDGJEykY73JdjJyatLGMYacgEkO46SMr4Q4fibN"
  }
}
2018-02-23 14:40:52.652 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-23 14:40:52.663 +05:30 [DBG] Creating Implicit Flow response.
2018-02-23 14:40:52.677 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-23 14:40:52.678 +05:30 [DBG] Getting claims for access token for subject: 88421113
2018-02-23 14:40:56.500 +05:30 [DBG] Getting claims for identity token for subject: 88421113 and client: mvc
2018-02-23 14:40:57.673 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "88421113",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "LwDGJEykY73JdjJyatLGMYacgEkO46SMr4Q4fibN",
  "Scope": "openid profile"
}
2018-02-23 14:40:58.461 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:40:58.578 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 14:40:58.590 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:40:58.590 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:40:58.623 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 14:40:58.624 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 14:40:58.624 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 14:40:58.633 +05:30 [DBG] Start discovery request
2018-02-23 14:40:58.696 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 14:40:58.731 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 14:40:58.738 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:40:58.738 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:40:58.745 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 14:40:58.746 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 14:40:58.747 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 14:40:58.751 +05:30 [DBG] Start key discovery request
2018-02-23 14:41:08.486 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:41:18.509 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:41:28.520 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:41:38.539 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:41:48.564 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:41:54.443 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 14:41:54.473 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:41:54.473 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:41:54.485 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 14:41:54.486 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 14:41:54.486 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 14:41:54.509 +05:30 [DBG] Start discovery request
2018-02-23 14:41:54.566 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 14:41:54.939 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 14:41:54.952 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:41:54.952 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:41:54.957 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 14:41:54.958 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 14:41:54.958 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 14:41:54.968 +05:30 [DBG] Start key discovery request
2018-02-23 14:41:56.399 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 14:41:56.399 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 14:41:56.400 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 14:41:56.417 +05:30 [DBG] Start authorize request
2018-02-23 14:41:56.418 +05:30 [DBG] No user present in authorize request
2018-02-23 14:41:56.418 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:41:56.530 +05:30 [DBG] mvc found in database: true
2018-02-23 14:41:56.542 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:41:56.550 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:41:56.560 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:41:56.564 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:41:56.565 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:41:56.565 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "FPB2sLk7KYSwLpq1qdHQMXldoDaTbri8TcCY14lC",
  "Nonce": "FPB2sLk7KYSwLpq1qdHQMXldoDaTbri8TcCY14lC",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "FPB2sLk7KYSwLpq1qdHQMXldoDaTbri8TcCY14lC",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "FPB2sLk7KYSwLpq1qdHQMXldoDaTbri8TcCY14lC"
  }
}
2018-02-23 14:41:56.568 +05:30 [INF] Showing login: User is not authenticated
2018-02-23 14:41:56.742 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:41:56.786 +05:30 [DBG] mvc found in database: true
2018-02-23 14:41:56.795 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:41:56.800 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:41:56.810 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:41:56.815 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:41:56.816 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:41:56.877 +05:30 [DBG] mvc found in database: true
2018-02-23 14:41:58.590 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:42:08.616 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:42:12.853 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:42:12.861 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:42:12.867 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:42:12.885 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-23 14:42:12.892 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-23 14:42:13.050 +05:30 [DBG] Augmenting SignInContext
2018-02-23 14:42:13.053 +05:30 [DBG] Adding idp claim with value: local
2018-02-23 14:42:13.053 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-23 14:42:13.068 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 14:42:13.104 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:42:13.107 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:42:13.109 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-23 14:42:13.111 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-23 14:42:13.111 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-23 14:42:13.121 +05:30 [DBG] Start authorize callback request
2018-02-23 14:42:13.126 +05:30 [DBG] User in authorize request: 1
2018-02-23 14:42:13.126 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:42:13.193 +05:30 [DBG] mvc found in database: true
2018-02-23 14:42:13.205 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:42:13.212 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:42:13.220 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:42:13.225 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:42:13.225 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:42:13.225 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "FPB2sLk7KYSwLpq1qdHQMXldoDaTbri8TcCY14lC",
  "Nonce": "FPB2sLk7KYSwLpq1qdHQMXldoDaTbri8TcCY14lC",
  "SessionId": "3bda07b19180daa2db988ec051209ccc",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "FPB2sLk7KYSwLpq1qdHQMXldoDaTbri8TcCY14lC",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "FPB2sLk7KYSwLpq1qdHQMXldoDaTbri8TcCY14lC"
  }
}
2018-02-23 14:42:13.249 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-23 14:42:13.249 +05:30 [DBG] Creating Implicit Flow response.
2018-02-23 14:42:13.249 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-23 14:42:13.249 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-23 14:42:19.251 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:42:26.201 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-23 14:42:27.747 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "FPB2sLk7KYSwLpq1qdHQMXldoDaTbri8TcCY14lC",
  "Scope": "openid profile"
}
2018-02-23 14:42:27.758 +05:30 [DBG] Augmenting SignInContext
2018-02-23 14:42:27.759 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 14:42:29.265 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:42:30.010 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 14:42:30.022 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:42:30.022 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:42:30.026 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 14:42:30.026 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 14:42:30.027 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 14:42:30.033 +05:30 [DBG] Start discovery request
2018-02-23 14:42:30.074 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 14:42:30.459 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 14:42:30.474 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:42:30.474 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:42:30.483 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 14:42:30.483 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 14:42:30.483 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 14:42:30.488 +05:30 [DBG] Start key discovery request
2018-02-23 14:42:39.278 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:42:49.288 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:43:16.422 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-23 14:43:16.465 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-23 14:43:16.465 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-23 14:43:16.467 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-23 14:43:16.468 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-23 14:43:16.660 +05:30 [DBG] Starting token cleanup
2018-02-23 14:43:17.150 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:43:17.183 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:43:25.904 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 14:43:27.201 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:43:27.211 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:43:27.240 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 14:43:27.253 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:43:27.271 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 14:43:27.272 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 14:43:27.281 +05:30 [DBG] Start discovery request
2018-02-23 14:43:28.487 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 14:43:28.633 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 14:43:28.644 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:43:28.644 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:43:28.647 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 14:43:28.648 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 14:43:28.648 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 14:43:28.656 +05:30 [DBG] Start key discovery request
2018-02-23 14:43:28.729 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 14:43:28.738 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 14:43:28.739 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 14:43:28.748 +05:30 [DBG] Start authorize request
2018-02-23 14:43:28.761 +05:30 [DBG] No user present in authorize request
2018-02-23 14:43:28.768 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:43:29.273 +05:30 [DBG] mvc found in database: true
2018-02-23 14:43:29.350 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:43:29.411 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:43:29.432 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:43:29.437 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:43:29.449 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:43:29.472 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "E6VrRMd6dXEtbMuUWgvq2Rov0a5MaWLp7XPz8dwA",
  "Nonce": "E6VrRMd6dXEtbMuUWgvq2Rov0a5MaWLp7XPz8dwA",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "E6VrRMd6dXEtbMuUWgvq2Rov0a5MaWLp7XPz8dwA",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "E6VrRMd6dXEtbMuUWgvq2Rov0a5MaWLp7XPz8dwA"
  }
}
2018-02-23 14:43:29.490 +05:30 [INF] Showing login: User is not authenticated
2018-02-23 14:43:29.605 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:43:29.666 +05:30 [DBG] mvc found in database: true
2018-02-23 14:43:29.680 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:43:29.691 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:43:29.704 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:43:29.712 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:43:29.712 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:43:29.782 +05:30 [DBG] mvc found in database: true
2018-02-23 14:43:34.603 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:43:34.611 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:43:34.615 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:43:34.619 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-23 14:43:34.622 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-23 14:43:34.729 +05:30 [DBG] Augmenting SignInContext
2018-02-23 14:43:34.733 +05:30 [DBG] Adding idp claim with value: local
2018-02-23 14:43:34.733 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-23 14:43:34.745 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 14:43:34.765 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:43:34.768 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:43:34.770 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-23 14:43:34.772 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-23 14:43:34.772 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-23 14:43:34.782 +05:30 [DBG] Start authorize callback request
2018-02-23 14:43:34.788 +05:30 [DBG] User in authorize request: 1
2018-02-23 14:43:34.788 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:43:34.844 +05:30 [DBG] mvc found in database: true
2018-02-23 14:43:34.862 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:43:34.872 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:43:34.884 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:43:34.889 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:43:34.889 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:43:34.890 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "E6VrRMd6dXEtbMuUWgvq2Rov0a5MaWLp7XPz8dwA",
  "Nonce": "E6VrRMd6dXEtbMuUWgvq2Rov0a5MaWLp7XPz8dwA",
  "SessionId": "4fc2931f08729a4b140c2d90a6aee8bb",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "E6VrRMd6dXEtbMuUWgvq2Rov0a5MaWLp7XPz8dwA",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "E6VrRMd6dXEtbMuUWgvq2Rov0a5MaWLp7XPz8dwA"
  }
}
2018-02-23 14:43:34.961 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-23 14:43:34.972 +05:30 [DBG] Creating Implicit Flow response.
2018-02-23 14:43:34.988 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-23 14:43:34.988 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-23 14:43:39.692 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:43:39.885 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-23 14:43:41.215 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "E6VrRMd6dXEtbMuUWgvq2Rov0a5MaWLp7XPz8dwA",
  "Scope": "openid profile"
}
2018-02-23 14:43:41.239 +05:30 [DBG] Augmenting SignInContext
2018-02-23 14:43:41.240 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 14:43:43.166 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 14:43:43.179 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:43:43.179 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:43:43.184 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 14:43:43.184 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 14:43:43.184 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 14:43:43.203 +05:30 [DBG] Start discovery request
2018-02-23 14:43:43.264 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 14:43:43.565 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 14:43:43.578 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:43:43.578 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:43:43.584 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 14:43:43.584 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 14:43:43.584 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 14:43:43.609 +05:30 [DBG] Start key discovery request
2018-02-23 14:43:49.726 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:43:59.742 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:44:09.755 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:44:19.776 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:44:29.801 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:44:39.823 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:44:49.836 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:44:59.849 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:45:09.873 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:45:19.887 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:45:29.912 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:45:39.932 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:45:49.958 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:45:59.974 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:46:09.999 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:46:24.463 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-23 14:46:24.514 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-23 14:46:24.515 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-23 14:46:24.515 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-23 14:46:24.515 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-23 14:46:24.743 +05:30 [DBG] Starting token cleanup
2018-02-23 14:46:24.945 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:46:24.969 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:46:35.329 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:46:43.336 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 14:46:43.830 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:46:43.831 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:46:43.850 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 14:46:43.869 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 14:46:43.869 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 14:46:43.966 +05:30 [DBG] Start discovery request
2018-02-23 14:46:45.304 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 14:46:45.352 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:46:45.457 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 14:46:45.467 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:46:45.467 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:46:45.470 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 14:46:45.472 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 14:46:45.472 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 14:46:45.479 +05:30 [DBG] Start key discovery request
2018-02-23 14:46:45.545 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 14:46:45.554 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 14:46:45.554 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 14:46:45.562 +05:30 [DBG] Start authorize request
2018-02-23 14:46:45.577 +05:30 [DBG] No user present in authorize request
2018-02-23 14:46:45.585 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:46:46.079 +05:30 [DBG] mvc found in database: true
2018-02-23 14:46:46.137 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:46:46.189 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:46:46.209 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:46:46.214 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:46:46.226 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:46:46.254 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "ki9dUOP4kk8klvwPWo99HU9UsenVgoxs6vdiBuIN",
  "Nonce": "ki9dUOP4kk8klvwPWo99HU9UsenVgoxs6vdiBuIN",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "ki9dUOP4kk8klvwPWo99HU9UsenVgoxs6vdiBuIN",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "ki9dUOP4kk8klvwPWo99HU9UsenVgoxs6vdiBuIN"
  }
}
2018-02-23 14:46:46.278 +05:30 [INF] Showing login: User is not authenticated
2018-02-23 14:46:46.409 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:46:46.470 +05:30 [DBG] mvc found in database: true
2018-02-23 14:46:46.485 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:46:46.493 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:46:46.506 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:46:46.514 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:46:46.515 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:46:46.576 +05:30 [DBG] mvc found in database: true
2018-02-23 14:46:51.126 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:46:51.134 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:46:51.138 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:46:51.144 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-23 14:46:51.146 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-23 14:46:51.240 +05:30 [DBG] Augmenting SignInContext
2018-02-23 14:46:51.243 +05:30 [DBG] Adding idp claim with value: local
2018-02-23 14:46:51.243 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-23 14:46:51.258 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 14:46:51.279 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:46:51.281 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:46:51.284 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-23 14:46:51.285 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-23 14:46:51.286 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-23 14:46:51.295 +05:30 [DBG] Start authorize callback request
2018-02-23 14:46:51.302 +05:30 [DBG] User in authorize request: 1
2018-02-23 14:46:51.302 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:46:51.373 +05:30 [DBG] mvc found in database: true
2018-02-23 14:46:51.386 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:46:51.395 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:46:51.403 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:46:51.408 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:46:51.408 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:46:51.408 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "ki9dUOP4kk8klvwPWo99HU9UsenVgoxs6vdiBuIN",
  "Nonce": "ki9dUOP4kk8klvwPWo99HU9UsenVgoxs6vdiBuIN",
  "SessionId": "88487fe1d1ad5a4d880f2c724caa46d0",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "ki9dUOP4kk8klvwPWo99HU9UsenVgoxs6vdiBuIN",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "ki9dUOP4kk8klvwPWo99HU9UsenVgoxs6vdiBuIN"
  }
}
2018-02-23 14:46:51.461 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-23 14:46:51.473 +05:30 [DBG] Creating Implicit Flow response.
2018-02-23 14:46:51.490 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-23 14:46:51.491 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-23 14:46:54.315 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-23 14:46:54.414 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-23 14:46:55.704 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-23 14:46:55.718 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:46:55.744 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "ki9dUOP4kk8klvwPWo99HU9UsenVgoxs6vdiBuIN",
  "Scope": "openid profile"
}
2018-02-23 14:46:55.771 +05:30 [DBG] Augmenting SignInContext
2018-02-23 14:46:55.772 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 14:46:57.247 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 14:46:57.270 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:46:57.270 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:46:57.274 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 14:46:57.275 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 14:46:57.275 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 14:46:57.286 +05:30 [DBG] Start discovery request
2018-02-23 14:46:57.366 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 14:46:57.810 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 14:46:57.830 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:46:57.831 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:46:57.837 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 14:46:57.837 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 14:46:57.837 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 14:46:57.858 +05:30 [DBG] Start key discovery request
2018-02-23 14:47:05.747 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:47:15.759 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:47:25.770 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:47:35.789 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:48:01.569 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-23 14:48:01.615 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-23 14:48:01.615 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-23 14:48:01.615 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-23 14:48:01.615 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-23 14:48:01.838 +05:30 [DBG] Starting token cleanup
2018-02-23 14:48:02.108 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:48:02.137 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:48:12.433 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:48:13.216 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 14:48:13.633 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:48:13.634 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:48:13.649 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 14:48:13.666 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 14:48:13.666 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 14:48:13.702 +05:30 [DBG] Start discovery request
2018-02-23 14:48:15.130 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 14:48:15.400 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 14:48:15.416 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:48:15.416 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:48:15.426 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 14:48:15.428 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 14:48:15.428 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 14:48:15.449 +05:30 [DBG] Start key discovery request
2018-02-23 14:48:22.469 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:48:31.633 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 14:48:31.644 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:48:31.644 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:48:31.658 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 14:48:31.671 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 14:48:31.672 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 14:48:31.683 +05:30 [DBG] Start discovery request
2018-02-23 14:48:31.745 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 14:48:32.131 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 14:48:32.151 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:48:32.151 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:48:32.168 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 14:48:32.169 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 14:48:32.171 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 14:48:32.180 +05:30 [DBG] Start key discovery request
2018-02-23 14:48:32.482 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:48:33.123 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 14:48:33.132 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 14:48:33.133 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 14:48:33.147 +05:30 [DBG] Start authorize request
2018-02-23 14:48:33.166 +05:30 [DBG] No user present in authorize request
2018-02-23 14:48:33.178 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:48:33.783 +05:30 [DBG] mvc found in database: true
2018-02-23 14:48:33.873 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:48:33.948 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:48:33.970 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:48:33.975 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:48:33.984 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:48:34.003 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "XBAxusgdarrmKSicJfwaQPvFDsSIlpDMqMrjvvWW",
  "Nonce": "XBAxusgdarrmKSicJfwaQPvFDsSIlpDMqMrjvvWW",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "XBAxusgdarrmKSicJfwaQPvFDsSIlpDMqMrjvvWW",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "XBAxusgdarrmKSicJfwaQPvFDsSIlpDMqMrjvvWW"
  }
}
2018-02-23 14:48:34.018 +05:30 [INF] Showing login: User is not authenticated
2018-02-23 14:48:34.158 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:48:34.211 +05:30 [DBG] mvc found in database: true
2018-02-23 14:48:34.223 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:48:34.232 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:48:34.245 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:48:34.252 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:48:34.252 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:48:34.292 +05:30 [DBG] mvc found in database: true
2018-02-23 14:48:39.034 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:48:39.045 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:48:39.051 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 14:48:39.057 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-23 14:48:39.064 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-23 14:48:39.184 +05:30 [DBG] Augmenting SignInContext
2018-02-23 14:48:39.187 +05:30 [DBG] Adding idp claim with value: local
2018-02-23 14:48:39.187 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-23 14:48:39.200 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 14:48:39.220 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:48:39.224 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:48:39.228 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-23 14:48:39.230 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-23 14:48:39.230 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-23 14:48:39.242 +05:30 [DBG] Start authorize callback request
2018-02-23 14:48:39.253 +05:30 [DBG] User in authorize request: 1
2018-02-23 14:48:39.253 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:48:39.334 +05:30 [DBG] mvc found in database: true
2018-02-23 14:48:39.350 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:48:39.362 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:48:39.375 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:48:39.383 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:48:39.383 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:48:39.384 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "XBAxusgdarrmKSicJfwaQPvFDsSIlpDMqMrjvvWW",
  "Nonce": "XBAxusgdarrmKSicJfwaQPvFDsSIlpDMqMrjvvWW",
  "SessionId": "97c1b5741486c5bd38417e0c3969a0fd",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "XBAxusgdarrmKSicJfwaQPvFDsSIlpDMqMrjvvWW",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "XBAxusgdarrmKSicJfwaQPvFDsSIlpDMqMrjvvWW"
  }
}
2018-02-23 14:48:39.438 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-23 14:48:39.449 +05:30 [DBG] Creating Implicit Flow response.
2018-02-23 14:48:39.465 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-23 14:48:39.466 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-23 14:48:50.620 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:53:56.096 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-23 14:53:56.158 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-23 14:53:56.158 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-23 14:53:56.159 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-23 14:53:56.159 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-23 14:53:56.372 +05:30 [DBG] Starting token cleanup
2018-02-23 14:53:56.642 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:53:56.673 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:54:06.837 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:54:16.867 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:54:26.305 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 14:54:26.669 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:54:26.670 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:54:26.684 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 14:54:26.704 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 14:54:26.704 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 14:54:26.714 +05:30 [DBG] Start discovery request
2018-02-23 14:54:26.907 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:54:28.102 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 14:54:28.299 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 14:54:28.320 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:54:28.320 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:54:28.323 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 14:54:28.324 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 14:54:28.325 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 14:54:28.337 +05:30 [DBG] Start key discovery request
2018-02-23 14:54:28.435 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:54:28.439 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 14:54:28.443 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 14:54:28.453 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 14:54:28.453 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 14:54:28.465 +05:30 [DBG] Start authorize request
2018-02-23 14:54:28.487 +05:30 [DBG] User in authorize request: 1
2018-02-23 14:54:28.495 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 14:54:28.920 +05:30 [DBG] mvc found in database: true
2018-02-23 14:54:28.998 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:54:29.060 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:54:29.083 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 14:54:29.091 +05:30 [DBG] Found [] API scopes in database
2018-02-23 14:54:29.100 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 14:54:29.120 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "N4bSdhJUd19BzBUxVsZoGI9GQ9iLZIYL6mcqFIhB",
  "Nonce": "N4bSdhJUd19BzBUxVsZoGI9GQ9iLZIYL6mcqFIhB",
  "SessionId": "97c1b5741486c5bd38417e0c3969a0fd",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "N4bSdhJUd19BzBUxVsZoGI9GQ9iLZIYL6mcqFIhB",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "N4bSdhJUd19BzBUxVsZoGI9GQ9iLZIYL6mcqFIhB"
  }
}
2018-02-23 14:54:29.269 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-23 14:54:29.279 +05:30 [DBG] Creating Implicit Flow response.
2018-02-23 14:54:29.293 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-23 14:54:29.294 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-23 14:54:32.639 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-23 14:54:34.706 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "N4bSdhJUd19BzBUxVsZoGI9GQ9iLZIYL6mcqFIhB",
  "Scope": "openid profile"
}
2018-02-23 14:54:34.751 +05:30 [DBG] Augmenting SignInContext
2018-02-23 14:54:34.766 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 14:54:36.166 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 14:54:36.178 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:54:36.178 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:54:36.186 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 14:54:36.187 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 14:54:36.187 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 14:54:36.200 +05:30 [DBG] Start discovery request
2018-02-23 14:54:36.238 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 14:54:36.719 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 14:54:36.730 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 14:54:36.730 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 14:54:36.735 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 14:54:36.736 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 14:54:36.736 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 14:54:36.745 +05:30 [DBG] Start key discovery request
2018-02-23 14:54:36.996 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:54:47.055 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:54:57.070 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:55:07.084 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:55:17.106 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:55:27.117 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:55:37.142 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:55:47.163 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:55:57.184 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:56:07.194 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:56:17.217 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:56:27.227 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:56:37.253 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:56:47.277 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:56:57.303 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:57:07.322 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:57:17.333 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:57:27.350 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:57:37.367 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:57:47.390 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:57:57.410 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:58:07.428 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:58:17.442 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:58:27.461 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:58:37.473 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:58:47.491 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:58:57.512 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:59:07.527 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:59:17.539 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:59:27.562 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:59:37.583 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:59:47.600 +05:30 [INF] Clearing 0 tokens
2018-02-23 14:59:57.621 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:00:07.633 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:00:17.650 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:00:27.667 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:00:37.682 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:00:47.693 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:00:57.711 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:01:07.733 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:01:17.756 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:01:27.778 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:01:37.789 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:01:47.810 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:01:57.838 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:02:07.853 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:02:17.866 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:02:27.890 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:02:37.912 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:02:47.933 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:02:57.944 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:03:07.966 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:03:17.990 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:03:28.013 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:03:38.040 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:03:48.053 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:03:58.068 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:04:08.091 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:04:18.102 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:04:28.114 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:04:38.135 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:04:48.145 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:04:58.164 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:05:08.184 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:05:18.196 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:05:28.209 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:05:38.231 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:05:48.242 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:05:58.265 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:06:08.275 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:06:18.287 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:06:28.306 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:06:38.320 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:06:48.341 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:06:58.353 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:07:08.374 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:07:18.396 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:07:28.418 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:07:38.430 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:07:48.454 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:07:58.476 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:08:08.495 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:08:18.507 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:08:28.528 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:08:38.543 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:08:48.554 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:08:58.577 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:09:08.599 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:09:18.616 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:09:28.638 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:09:38.662 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:09:48.685 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:09:58.696 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:10:08.708 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:10:18.725 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:10:28.746 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:10:38.756 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:10:48.774 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:10:58.785 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:11:08.802 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:11:18.820 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:11:28.844 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:11:38.866 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:11:48.891 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:11:58.915 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:12:08.926 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:12:18.944 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:12:28.965 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:12:38.977 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:12:49.000 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:12:59.018 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:13:09.034 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:13:19.054 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:13:29.075 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:13:39.084 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:13:49.104 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:13:59.130 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:14:09.147 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:14:19.168 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:14:29.180 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:14:39.204 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:14:49.225 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:14:59.244 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:15:09.264 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:15:19.284 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:15:29.300 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:15:39.319 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:15:49.339 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:15:59.347 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:16:09.366 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:16:19.387 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:16:29.398 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:16:39.417 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:16:49.432 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:16:59.442 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:17:09.461 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:17:19.482 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:17:29.499 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:17:39.521 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:17:49.539 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:17:59.551 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:18:09.567 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:18:19.583 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:18:29.599 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:18:39.618 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:18:49.654 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:18:59.677 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:19:09.700 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:19:19.710 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:19:29.732 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:19:39.744 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:19:49.757 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:19:59.782 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:20:09.805 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:20:19.823 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:20:29.835 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:20:39.852 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:20:49.874 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:20:59.896 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:21:09.914 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:21:19.938 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:21:29.957 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:21:39.975 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:21:49.994 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:22:00.004 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:22:10.023 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:22:20.035 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:22:30.056 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:22:40.076 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:22:50.099 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:23:00.118 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:23:10.141 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:23:20.161 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:23:30.179 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:23:40.198 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:23:50.212 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:24:00.235 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:24:10.256 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:24:20.276 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:24:30.287 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:24:40.305 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:24:50.325 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:25:00.350 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:25:10.370 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:25:20.380 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:25:30.402 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:25:40.413 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:25:50.433 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:26:00.443 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:26:10.463 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:26:20.474 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:26:30.495 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:26:40.510 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:26:50.521 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:27:00.543 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:27:10.559 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:27:20.568 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:27:30.595 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:27:40.614 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:27:50.633 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:28:00.654 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:28:10.662 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:28:20.682 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:28:30.690 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:28:40.711 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:28:50.731 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:29:00.742 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:29:10.763 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:29:20.772 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:29:30.787 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:29:40.806 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:29:50.816 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:30:00.837 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:30:10.857 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:30:20.879 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:30:30.895 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:30:40.910 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:30:50.926 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:31:00.943 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:31:10.961 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:31:20.982 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:31:30.990 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:31:41.005 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:31:51.021 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:32:01.041 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:32:11.055 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:32:21.076 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:32:31.085 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:32:41.101 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:32:51.119 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:33:01.128 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:33:11.147 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:33:21.169 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:33:31.179 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:33:41.195 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:33:51.212 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:34:01.223 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:34:11.237 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:34:21.254 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:34:31.275 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:34:41.285 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:34:51.302 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:35:01.320 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:35:11.344 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:35:21.368 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:35:31.381 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:35:41.400 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:35:51.409 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:36:01.430 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:36:11.441 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:36:21.462 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:36:31.473 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:36:41.490 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:36:51.512 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:37:01.523 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:37:11.544 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:37:21.554 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:37:31.576 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:37:41.597 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:37:51.621 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:38:01.632 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:38:11.654 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:38:21.663 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:38:31.686 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:38:41.708 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:38:51.728 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:39:01.738 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:39:11.755 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:39:21.773 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:39:31.795 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:39:41.818 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:39:51.836 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:40:01.858 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:40:11.880 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:40:21.900 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:40:31.911 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:40:41.931 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:40:51.942 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:41:01.960 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:41:11.979 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:41:21.990 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:41:32.010 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:41:42.020 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:41:52.038 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:42:02.059 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:42:12.071 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:42:22.095 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:42:32.116 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:42:42.136 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:42:52.147 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:43:02.169 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:43:12.192 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:43:22.211 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:43:32.232 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:43:42.242 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:43:52.263 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:44:02.287 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:44:12.307 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:44:22.318 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:44:32.341 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:44:42.355 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:44:52.366 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:45:02.389 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:45:12.413 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:45:22.438 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:45:32.460 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:45:42.495 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:45:52.506 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:46:02.530 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:46:12.539 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:46:22.561 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:46:32.584 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:46:42.602 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:46:52.621 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:47:02.638 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:47:12.648 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:47:22.681 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:47:32.701 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:47:42.716 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:47:52.726 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:48:02.744 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:48:12.761 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:48:22.788 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:48:32.808 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:48:42.818 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:48:52.834 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:49:02.858 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:49:12.867 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:49:22.879 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:49:32.895 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:49:42.913 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:49:52.934 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:50:02.945 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:50:12.961 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:50:22.973 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:50:32.990 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:50:43.012 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:50:53.022 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:51:03.040 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:51:13.055 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:51:23.081 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:51:33.099 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:51:43.115 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:51:53.135 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:52:03.147 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:52:13.170 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:52:23.182 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:52:33.194 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:52:43.214 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:52:53.225 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:53:03.244 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:53:13.257 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:53:23.274 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:53:33.296 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:53:43.306 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:53:53.319 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:54:03.344 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:54:13.365 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:54:23.385 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:54:33.396 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:54:43.426 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:54:53.446 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:55:03.459 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:55:13.479 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:55:23.489 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:55:33.511 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:55:43.523 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:55:53.539 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:56:03.562 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:56:13.583 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:56:23.600 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:56:33.622 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:56:43.645 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:56:53.663 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:57:03.684 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:57:13.695 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:57:23.717 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:57:33.729 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:57:43.740 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:57:53.763 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:58:03.786 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:58:13.804 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:58:23.827 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:58:33.851 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:58:43.871 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:58:53.884 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:59:03.905 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:59:13.926 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:59:23.945 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:59:33.966 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:59:43.979 +05:30 [INF] Clearing 0 tokens
2018-02-23 15:59:53.989 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:00:04.007 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:00:14.024 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:00:24.036 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:00:34.057 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:00:44.073 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:00:54.085 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:01:04.107 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:01:14.117 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:01:24.139 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:01:34.150 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:01:44.164 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:01:54.189 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:02:04.214 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:02:14.225 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:02:24.249 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:02:34.271 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:02:44.288 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:02:54.306 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:03:04.327 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:03:14.352 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:03:24.372 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:03:34.384 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:03:44.405 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:03:54.427 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:04:04.445 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:04:14.467 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:04:24.477 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:04:34.490 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:04:44.512 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:04:54.524 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:05:04.544 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:05:14.555 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:05:24.576 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:05:34.601 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:05:44.613 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:05:54.630 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:06:04.656 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:06:14.678 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:06:24.697 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:06:34.707 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:06:44.782 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:06:54.802 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:07:04.824 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:07:14.835 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:07:24.855 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:07:34.868 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:07:44.891 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:07:54.912 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:08:04.931 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:08:14.943 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:08:24.966 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:08:34.976 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:08:44.988 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:08:55.005 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:09:05.025 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:09:15.039 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:09:25.059 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:09:35.070 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:09:45.093 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:09:55.115 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:10:05.135 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:10:15.146 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:10:25.169 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:10:35.180 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:10:45.198 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:10:55.209 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:11:05.231 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:11:15.242 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:11:25.265 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:11:35.285 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:11:41.097 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 16:11:41.152 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 16:11:41.152 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 16:11:41.158 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 16:11:41.158 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 16:11:41.158 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 16:11:41.161 +05:30 [DBG] Start discovery request
2018-02-23 16:11:41.201 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 16:11:41.498 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 16:11:41.509 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 16:11:41.509 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 16:11:41.514 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 16:11:41.515 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 16:11:41.515 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 16:11:41.521 +05:30 [DBG] Start key discovery request
2018-02-23 16:11:42.766 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 16:11:42.768 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 16:11:42.768 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 16:11:42.817 +05:30 [DBG] Start authorize request
2018-02-23 16:11:42.818 +05:30 [DBG] No user present in authorize request
2018-02-23 16:11:42.818 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 16:11:43.203 +05:30 [DBG] mvc found in database: true
2018-02-23 16:11:43.229 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:11:43.237 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:11:43.246 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:11:43.252 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:11:43.252 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 16:11:43.252 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "xmvjUDwXGeF00RezvrFDutQYIOFXKQppbvsNWiEJ",
  "Nonce": "xmvjUDwXGeF00RezvrFDutQYIOFXKQppbvsNWiEJ",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "xmvjUDwXGeF00RezvrFDutQYIOFXKQppbvsNWiEJ",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "xmvjUDwXGeF00RezvrFDutQYIOFXKQppbvsNWiEJ"
  }
}
2018-02-23 16:11:43.255 +05:30 [INF] Showing login: User is not authenticated
2018-02-23 16:11:43.445 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 16:11:43.513 +05:30 [DBG] mvc found in database: true
2018-02-23 16:11:43.530 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:11:43.553 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:11:43.567 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:11:43.577 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:11:43.577 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 16:11:43.696 +05:30 [DBG] mvc found in database: true
2018-02-23 16:11:45.334 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:11:49.983 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 16:11:49.991 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 16:11:49.995 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 16:11:50.000 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-23 16:11:50.003 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-23 16:11:50.105 +05:30 [DBG] Augmenting SignInContext
2018-02-23 16:11:50.105 +05:30 [DBG] Adding idp claim with value: local
2018-02-23 16:11:50.105 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-23 16:11:50.109 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 16:11:50.129 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:11:50.131 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:11:50.135 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-23 16:11:50.137 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-23 16:11:50.137 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-23 16:11:50.147 +05:30 [DBG] Start authorize callback request
2018-02-23 16:11:50.153 +05:30 [DBG] User in authorize request: 1
2018-02-23 16:11:50.153 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 16:11:50.218 +05:30 [DBG] mvc found in database: true
2018-02-23 16:11:50.230 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:11:50.246 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:11:50.255 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:11:50.261 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:11:50.261 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 16:11:50.261 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "xmvjUDwXGeF00RezvrFDutQYIOFXKQppbvsNWiEJ",
  "Nonce": "xmvjUDwXGeF00RezvrFDutQYIOFXKQppbvsNWiEJ",
  "SessionId": "5891e4ad6e4ce75c7a9427c86880ed08",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "xmvjUDwXGeF00RezvrFDutQYIOFXKQppbvsNWiEJ",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "xmvjUDwXGeF00RezvrFDutQYIOFXKQppbvsNWiEJ"
  }
}
2018-02-23 16:11:50.280 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-23 16:11:50.281 +05:30 [DBG] Creating Implicit Flow response.
2018-02-23 16:11:50.281 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-23 16:11:50.281 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-23 16:12:00.620 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:12:11.243 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-23 16:12:12.359 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:12:14.145 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "xmvjUDwXGeF00RezvrFDutQYIOFXKQppbvsNWiEJ",
  "Scope": "openid profile"
}
2018-02-23 16:12:14.149 +05:30 [DBG] Augmenting SignInContext
2018-02-23 16:12:14.149 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 16:12:16.251 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 16:12:16.266 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 16:12:16.266 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 16:12:16.275 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 16:12:16.276 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 16:12:16.276 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 16:12:16.285 +05:30 [DBG] Start discovery request
2018-02-23 16:12:16.372 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 16:12:16.711 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 16:12:16.726 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 16:12:16.726 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 16:12:16.730 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 16:12:16.731 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 16:12:16.731 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 16:12:16.736 +05:30 [DBG] Start key discovery request
2018-02-23 16:12:22.382 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:12:32.406 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:14:18.825 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-23 16:14:18.865 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-23 16:14:18.865 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-23 16:14:18.865 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-23 16:14:18.865 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-23 16:14:19.068 +05:30 [DBG] Starting token cleanup
2018-02-23 16:14:19.376 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:14:19.409 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:14:29.755 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:14:39.794 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:14:45.286 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 16:14:45.678 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 16:14:45.679 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 16:14:45.684 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 16:14:45.697 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 16:14:45.697 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 16:14:45.706 +05:30 [DBG] Start discovery request
2018-02-23 16:14:46.595 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 16:14:46.749 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 16:14:46.760 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 16:14:46.760 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 16:14:46.763 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 16:14:46.764 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 16:14:46.764 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 16:14:46.771 +05:30 [DBG] Start key discovery request
2018-02-23 16:14:46.863 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 16:14:46.868 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 16:14:46.869 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 16:14:46.878 +05:30 [DBG] Start authorize request
2018-02-23 16:14:46.892 +05:30 [DBG] No user present in authorize request
2018-02-23 16:14:46.899 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 16:14:47.371 +05:30 [DBG] mvc found in database: true
2018-02-23 16:14:47.428 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:14:47.485 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:14:47.509 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:14:47.518 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:14:47.528 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 16:14:47.547 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "vYjDepuqM5QtjaoIWJynNzS33RhVkFznrgIOuhOO",
  "Nonce": "vYjDepuqM5QtjaoIWJynNzS33RhVkFznrgIOuhOO",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "vYjDepuqM5QtjaoIWJynNzS33RhVkFznrgIOuhOO",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "vYjDepuqM5QtjaoIWJynNzS33RhVkFznrgIOuhOO"
  }
}
2018-02-23 16:14:47.563 +05:30 [INF] Showing login: User is not authenticated
2018-02-23 16:14:47.692 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 16:14:47.748 +05:30 [DBG] mvc found in database: true
2018-02-23 16:14:47.772 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:14:47.780 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:14:47.790 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:14:47.801 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:14:47.801 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 16:14:47.908 +05:30 [DBG] mvc found in database: true
2018-02-23 16:14:49.807 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:14:56.217 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 16:14:56.227 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 16:14:56.231 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 16:14:56.235 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-23 16:14:56.240 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-23 16:14:56.356 +05:30 [DBG] Augmenting SignInContext
2018-02-23 16:14:56.359 +05:30 [DBG] Adding idp claim with value: local
2018-02-23 16:14:56.359 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-23 16:14:56.373 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 16:14:56.395 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:14:56.398 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:14:56.400 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-23 16:14:56.401 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-23 16:14:56.401 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-23 16:14:56.412 +05:30 [DBG] Start authorize callback request
2018-02-23 16:14:56.417 +05:30 [DBG] User in authorize request: 1
2018-02-23 16:14:56.417 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 16:14:56.501 +05:30 [DBG] mvc found in database: true
2018-02-23 16:14:56.518 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:14:56.529 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:14:56.543 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:14:56.556 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:14:56.556 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 16:14:56.556 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "vYjDepuqM5QtjaoIWJynNzS33RhVkFznrgIOuhOO",
  "Nonce": "vYjDepuqM5QtjaoIWJynNzS33RhVkFznrgIOuhOO",
  "SessionId": "94f9125eed7be3a12f336199122ab10e",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "vYjDepuqM5QtjaoIWJynNzS33RhVkFznrgIOuhOO",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "vYjDepuqM5QtjaoIWJynNzS33RhVkFznrgIOuhOO"
  }
}
2018-02-23 16:14:56.611 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-23 16:14:56.621 +05:30 [DBG] Creating Implicit Flow response.
2018-02-23 16:14:56.635 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-23 16:14:56.636 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-23 16:15:00.366 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:17:24.447 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:17:24.536 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-23 16:17:30.908 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "vYjDepuqM5QtjaoIWJynNzS33RhVkFznrgIOuhOO",
  "Scope": "openid profile"
}
2018-02-23 16:17:30.939 +05:30 [DBG] Augmenting SignInContext
2018-02-23 16:17:30.939 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 16:17:34.463 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:17:44.465 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:17:54.482 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:17:58.349 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 16:17:58.358 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 16:17:58.358 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 16:17:58.361 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 16:17:58.361 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 16:17:58.361 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 16:17:58.364 +05:30 [DBG] Start discovery request
2018-02-23 16:17:58.462 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 16:17:58.519 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 16:17:58.562 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 16:17:58.562 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 16:17:58.567 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 16:17:58.568 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 16:17:58.568 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 16:17:58.595 +05:30 [DBG] Start key discovery request
2018-02-23 16:17:59.019 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 16:17:59.019 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 16:17:59.019 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 16:17:59.030 +05:30 [DBG] Start authorize request
2018-02-23 16:17:59.031 +05:30 [DBG] No user present in authorize request
2018-02-23 16:17:59.031 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 16:17:59.125 +05:30 [DBG] mvc found in database: true
2018-02-23 16:17:59.141 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:17:59.153 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:17:59.183 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:17:59.192 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:17:59.193 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 16:17:59.193 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "kcRtk7aB1yaI6PdiztbEoTHt9dKK9ysTw11wEq2u",
  "Nonce": "kcRtk7aB1yaI6PdiztbEoTHt9dKK9ysTw11wEq2u",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "kcRtk7aB1yaI6PdiztbEoTHt9dKK9ysTw11wEq2u",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "kcRtk7aB1yaI6PdiztbEoTHt9dKK9ysTw11wEq2u"
  }
}
2018-02-23 16:17:59.196 +05:30 [INF] Showing login: User is not authenticated
2018-02-23 16:17:59.228 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 16:17:59.293 +05:30 [DBG] mvc found in database: true
2018-02-23 16:17:59.308 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:17:59.317 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:17:59.333 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:17:59.347 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:17:59.347 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 16:17:59.456 +05:30 [DBG] mvc found in database: true
2018-02-23 16:18:04.519 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:18:04.527 +05:30 [DBG] Augmenting SignInContext
2018-02-23 16:18:04.527 +05:30 [DBG] Adding idp claim with value: local
2018-02-23 16:18:04.527 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-23 16:18:04.527 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 16:18:04.549 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:18:04.551 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:18:04.553 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-23 16:18:04.555 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-23 16:18:04.556 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-23 16:18:04.563 +05:30 [DBG] Start authorize callback request
2018-02-23 16:18:04.563 +05:30 [DBG] User in authorize request: 1
2018-02-23 16:18:04.563 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 16:18:04.629 +05:30 [DBG] mvc found in database: true
2018-02-23 16:18:04.641 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:18:04.648 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:18:04.667 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:18:04.672 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:18:04.672 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 16:18:04.672 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "kcRtk7aB1yaI6PdiztbEoTHt9dKK9ysTw11wEq2u",
  "Nonce": "kcRtk7aB1yaI6PdiztbEoTHt9dKK9ysTw11wEq2u",
  "SessionId": "a3e257ba9b4ea0477f4b95d46cb6a82e",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "kcRtk7aB1yaI6PdiztbEoTHt9dKK9ysTw11wEq2u",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "kcRtk7aB1yaI6PdiztbEoTHt9dKK9ysTw11wEq2u"
  }
}
2018-02-23 16:18:04.692 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-23 16:18:04.692 +05:30 [DBG] Creating Implicit Flow response.
2018-02-23 16:18:04.693 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-23 16:18:04.693 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-23 16:32:41.200 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:32:46.150 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-23 16:34:17.441 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:34:49.758 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-23 16:34:49.806 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-23 16:34:49.806 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-23 16:34:49.806 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-23 16:34:49.806 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-23 16:34:50.014 +05:30 [DBG] Starting token cleanup
2018-02-23 16:34:50.347 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:34:50.376 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:34:54.538 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:34:54.573 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:35:00.616 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:35:10.664 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:35:20.689 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:35:30.707 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:35:40.718 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:35:50.730 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:36:00.747 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:36:10.766 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:36:20.777 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:36:30.799 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:36:40.805 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:36:50.816 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:37:00.828 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:37:10.844 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:37:20.857 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:37:30.878 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:37:40.883 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:37:50.889 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:38:00.903 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:38:10.912 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:38:20.919 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:38:30.936 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:38:40.946 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:38:50.956 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:39:00.967 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:39:10.973 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:39:20.985 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:39:30.994 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:39:41.016 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:39:51.029 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:59:00.134 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-23 16:59:00.180 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-23 16:59:00.180 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-23 16:59:00.180 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-23 16:59:00.180 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-23 16:59:00.379 +05:30 [DBG] Starting token cleanup
2018-02-23 16:59:01.126 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:59:01.162 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:59:10.857 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:59:14.347 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 16:59:14.791 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 16:59:14.792 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 16:59:14.816 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 16:59:14.833 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 16:59:14.833 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 16:59:14.897 +05:30 [DBG] Start discovery request
2018-02-23 16:59:15.795 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 16:59:15.919 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 16:59:15.930 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 16:59:15.931 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 16:59:15.935 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 16:59:15.938 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 16:59:15.938 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 16:59:15.946 +05:30 [DBG] Start key discovery request
2018-02-23 16:59:16.030 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:59:16.032 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 16:59:16.034 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 16:59:16.042 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 16:59:16.042 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 16:59:16.050 +05:30 [DBG] Start authorize request
2018-02-23 16:59:16.065 +05:30 [DBG] User in authorize request: 1
2018-02-23 16:59:16.072 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 16:59:16.546 +05:30 [DBG] mvc found in database: true
2018-02-23 16:59:16.621 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:59:16.671 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:59:16.693 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 16:59:16.698 +05:30 [DBG] Found [] API scopes in database
2018-02-23 16:59:16.707 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 16:59:16.726 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "ytFkqNSZHyWMAMlRA7J1q4E7lHGwtwPSXHAH3l4P",
  "Nonce": "ytFkqNSZHyWMAMlRA7J1q4E7lHGwtwPSXHAH3l4P",
  "SessionId": "a3e257ba9b4ea0477f4b95d46cb6a82e",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "ytFkqNSZHyWMAMlRA7J1q4E7lHGwtwPSXHAH3l4P",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "ytFkqNSZHyWMAMlRA7J1q4E7lHGwtwPSXHAH3l4P"
  }
}
2018-02-23 16:59:16.881 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-23 16:59:16.891 +05:30 [DBG] Creating Implicit Flow response.
2018-02-23 16:59:16.906 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-23 16:59:16.907 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-23 16:59:39.272 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:59:39.278 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-23 16:59:39.370 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-23 16:59:41.455 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-23 16:59:41.487 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "ytFkqNSZHyWMAMlRA7J1q4E7lHGwtwPSXHAH3l4P",
  "Scope": "openid profile"
}
2018-02-23 16:59:41.537 +05:30 [DBG] Augmenting SignInContext
2018-02-23 16:59:41.552 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 16:59:42.562 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 16:59:42.571 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 16:59:42.572 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 16:59:42.580 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 16:59:42.581 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 16:59:42.581 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 16:59:42.605 +05:30 [DBG] Start discovery request
2018-02-23 16:59:42.992 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 16:59:43.831 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 16:59:43.844 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 16:59:43.844 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 16:59:43.847 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 16:59:43.848 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 16:59:43.848 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 16:59:43.853 +05:30 [DBG] Start key discovery request
2018-02-23 16:59:49.296 +05:30 [INF] Clearing 0 tokens
2018-02-23 16:59:59.308 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:00:09.323 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:00:19.342 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:00:29.348 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:00:32.378 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 17:00:32.387 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:00:32.387 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:00:32.390 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 17:00:32.390 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 17:00:32.390 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 17:00:32.392 +05:30 [DBG] Start discovery request
2018-02-23 17:00:32.495 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 17:00:32.657 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 17:00:32.743 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:00:32.743 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:00:32.750 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 17:00:32.751 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 17:00:32.751 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 17:00:32.759 +05:30 [DBG] Start key discovery request
2018-02-23 17:00:33.137 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 17:00:33.139 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 17:00:33.139 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 17:00:33.156 +05:30 [DBG] Start authorize request
2018-02-23 17:00:33.157 +05:30 [DBG] No user present in authorize request
2018-02-23 17:00:33.157 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 17:00:33.237 +05:30 [DBG] mvc found in database: true
2018-02-23 17:00:33.251 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:00:33.265 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:00:33.279 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:00:33.290 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:00:33.290 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 17:00:33.291 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "Osry4kLjRvHnBrPk79WrTJSsbbwOvl5JHnzsMoK2",
  "Nonce": "Osry4kLjRvHnBrPk79WrTJSsbbwOvl5JHnzsMoK2",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "Osry4kLjRvHnBrPk79WrTJSsbbwOvl5JHnzsMoK2",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "Osry4kLjRvHnBrPk79WrTJSsbbwOvl5JHnzsMoK2"
  }
}
2018-02-23 17:00:33.292 +05:30 [INF] Showing login: User is not authenticated
2018-02-23 17:00:33.407 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 17:00:33.470 +05:30 [DBG] mvc found in database: true
2018-02-23 17:00:33.485 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:00:33.492 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:00:33.503 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:00:33.507 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:00:33.507 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 17:00:33.596 +05:30 [DBG] mvc found in database: true
2018-02-23 17:00:39.378 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:00:39.550 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 17:00:39.558 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 17:00:39.563 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 17:00:39.568 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-23 17:00:39.571 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-23 17:00:39.679 +05:30 [DBG] Augmenting SignInContext
2018-02-23 17:00:39.680 +05:30 [DBG] Adding idp claim with value: local
2018-02-23 17:00:39.680 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-23 17:00:39.684 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 17:00:39.719 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:00:39.725 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:00:39.728 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-23 17:00:39.730 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-23 17:00:39.730 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-23 17:00:39.745 +05:30 [DBG] Start authorize callback request
2018-02-23 17:00:39.753 +05:30 [DBG] User in authorize request: 1
2018-02-23 17:00:39.753 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 17:00:39.819 +05:30 [DBG] mvc found in database: true
2018-02-23 17:00:39.831 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:00:39.840 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:00:39.859 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:00:39.864 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:00:39.864 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 17:00:39.865 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "Osry4kLjRvHnBrPk79WrTJSsbbwOvl5JHnzsMoK2",
  "Nonce": "Osry4kLjRvHnBrPk79WrTJSsbbwOvl5JHnzsMoK2",
  "SessionId": "8f6a9e05bab88b0b8a00d08f392da486",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "Osry4kLjRvHnBrPk79WrTJSsbbwOvl5JHnzsMoK2",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "Osry4kLjRvHnBrPk79WrTJSsbbwOvl5JHnzsMoK2"
  }
}
2018-02-23 17:00:39.881 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-23 17:00:39.881 +05:30 [DBG] Creating Implicit Flow response.
2018-02-23 17:00:39.881 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-23 17:00:39.881 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-23 17:01:00.513 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:01:24.996 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-23 17:01:25.002 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:01:25.004 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-23 17:01:31.722 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-23 17:01:31.727 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "Osry4kLjRvHnBrPk79WrTJSsbbwOvl5JHnzsMoK2",
  "Scope": "openid profile"
}
2018-02-23 17:01:31.730 +05:30 [DBG] Augmenting SignInContext
2018-02-23 17:01:31.730 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 17:01:33.599 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 17:01:33.608 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:01:33.608 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:01:33.617 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 17:01:33.617 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 17:01:33.617 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 17:01:33.624 +05:30 [DBG] Start discovery request
2018-02-23 17:01:33.800 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 17:01:34.399 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 17:01:34.423 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:01:34.423 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:01:34.429 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 17:01:34.429 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 17:01:34.429 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 17:01:34.439 +05:30 [DBG] Start key discovery request
2018-02-23 17:01:35.022 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:01:45.038 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:01:55.051 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:02:05.061 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:02:15.080 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:02:25.097 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:02:35.109 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:02:45.126 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:02:55.146 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:04:10.984 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-23 17:04:11.051 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-23 17:04:11.051 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-23 17:04:11.052 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-23 17:04:11.052 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-23 17:04:11.283 +05:30 [DBG] Starting token cleanup
2018-02-23 17:04:11.695 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:04:11.728 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:04:15.539 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:04:15.549 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:04:22.137 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:04:23.233 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 17:04:23.605 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:04:23.606 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:04:23.616 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 17:04:23.631 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 17:04:23.632 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 17:04:23.644 +05:30 [DBG] Start discovery request
2018-02-23 17:04:24.843 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 17:04:25.043 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 17:04:25.055 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:04:25.055 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:04:25.058 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 17:04:25.059 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 17:04:25.060 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 17:04:25.069 +05:30 [DBG] Start key discovery request
2018-02-23 17:04:32.175 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:04:38.683 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 17:04:38.694 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:04:38.694 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:04:38.697 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 17:04:38.698 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 17:04:38.698 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 17:04:38.706 +05:30 [DBG] Start discovery request
2018-02-23 17:04:38.786 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 17:04:38.937 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 17:04:38.967 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:04:38.967 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:04:38.974 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 17:04:38.974 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 17:04:38.974 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 17:04:39.041 +05:30 [DBG] Start key discovery request
2018-02-23 17:04:39.383 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 17:04:39.392 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 17:04:39.392 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 17:04:39.406 +05:30 [DBG] Start authorize request
2018-02-23 17:04:39.430 +05:30 [DBG] No user present in authorize request
2018-02-23 17:04:39.440 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 17:04:39.950 +05:30 [DBG] mvc found in database: true
2018-02-23 17:04:40.024 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:04:40.085 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:04:40.115 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:04:40.120 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:04:40.129 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 17:04:40.152 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "JqCesOscLmifP1IcUOHFFCcospb4ETKXnvq3tA9U",
  "Nonce": "JqCesOscLmifP1IcUOHFFCcospb4ETKXnvq3tA9U",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "JqCesOscLmifP1IcUOHFFCcospb4ETKXnvq3tA9U",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "JqCesOscLmifP1IcUOHFFCcospb4ETKXnvq3tA9U"
  }
}
2018-02-23 17:04:40.168 +05:30 [INF] Showing login: User is not authenticated
2018-02-23 17:04:40.320 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 17:04:40.376 +05:30 [DBG] mvc found in database: true
2018-02-23 17:04:40.386 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:04:40.395 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:04:40.405 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:04:40.410 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:04:40.410 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 17:04:40.454 +05:30 [DBG] mvc found in database: true
2018-02-23 17:04:42.423 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:04:46.128 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 17:04:46.148 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 17:04:46.154 +05:30 [WRN] The LINQ expression 'where Equals([userrole].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 17:04:46.158 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userrole in {from User userrole in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userrole].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userrole]?, "Id"), Object)})} on Property([userrole.UserRole], "UserId") equals Convert([_userrole].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-23 17:04:46.163 +05:30 [WRN] The LINQ expression 'orderby [_userrole].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-23 17:04:46.272 +05:30 [DBG] Augmenting SignInContext
2018-02-23 17:04:46.276 +05:30 [DBG] Adding idp claim with value: local
2018-02-23 17:04:46.276 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-23 17:04:46.290 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 17:04:46.316 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:04:46.320 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:04:46.323 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-23 17:04:46.324 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-23 17:04:46.324 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-23 17:04:46.336 +05:30 [DBG] Start authorize callback request
2018-02-23 17:04:46.342 +05:30 [DBG] User in authorize request: 1
2018-02-23 17:04:46.342 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 17:04:46.414 +05:30 [DBG] mvc found in database: true
2018-02-23 17:04:46.425 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:04:46.434 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:04:46.442 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:04:46.447 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:04:46.448 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 17:04:46.448 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "JqCesOscLmifP1IcUOHFFCcospb4ETKXnvq3tA9U",
  "Nonce": "JqCesOscLmifP1IcUOHFFCcospb4ETKXnvq3tA9U",
  "SessionId": "34db79b6c26f9e89911739486af0b679",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "JqCesOscLmifP1IcUOHFFCcospb4ETKXnvq3tA9U",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "JqCesOscLmifP1IcUOHFFCcospb4ETKXnvq3tA9U"
  }
}
2018-02-23 17:04:46.504 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-23 17:04:46.515 +05:30 [DBG] Creating Implicit Flow response.
2018-02-23 17:04:46.532 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-23 17:04:46.533 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-23 17:04:57.337 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-23 17:04:57.343 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:04:57.440 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-23 17:05:00.870 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-23 17:05:00.888 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "JqCesOscLmifP1IcUOHFFCcospb4ETKXnvq3tA9U",
  "Scope": "openid profile"
}
2018-02-23 17:05:00.921 +05:30 [DBG] Augmenting SignInContext
2018-02-23 17:05:00.921 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 17:05:02.861 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 17:05:02.875 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:05:02.875 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:05:02.881 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 17:05:02.881 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 17:05:02.881 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 17:05:02.884 +05:30 [DBG] Start discovery request
2018-02-23 17:05:02.928 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 17:05:03.167 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 17:05:03.184 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:05:03.184 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:05:03.200 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 17:05:03.200 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 17:05:03.200 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 17:05:03.213 +05:30 [DBG] Start key discovery request
2018-02-23 17:05:07.362 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:05:17.377 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:05:27.387 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:05:37.404 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:05:47.415 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:05:57.426 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:06:07.437 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:06:17.443 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:06:29.115 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:06:39.160 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:06:49.169 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:06:59.203 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:07:09.205 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:07:19.259 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:07:29.276 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:07:39.307 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:07:49.318 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:07:59.332 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:08:09.357 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:08:19.371 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:08:29.383 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:08:39.397 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:08:49.405 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:08:59.411 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:09:09.417 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:09:19.422 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:09:29.432 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:09:39.453 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:09:49.459 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:09:59.465 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:10:09.479 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:10:19.484 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:10:29.494 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:10:39.528 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:10:49.555 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:10:59.573 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:11:09.637 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:11:19.654 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:11:29.661 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:11:39.672 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:11:49.682 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:11:55.640 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 17:11:55.675 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:11:55.675 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:11:55.682 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 17:11:55.683 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 17:11:55.683 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 17:11:55.686 +05:30 [DBG] Start discovery request
2018-02-23 17:11:55.732 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 17:11:55.754 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 17:11:55.775 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:11:55.775 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:11:55.777 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 17:11:55.777 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 17:11:55.778 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 17:11:55.785 +05:30 [DBG] Start key discovery request
2018-02-23 17:11:56.995 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 17:11:56.997 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 17:11:56.997 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 17:11:57.004 +05:30 [DBG] Start authorize request
2018-02-23 17:11:57.005 +05:30 [DBG] No user present in authorize request
2018-02-23 17:11:57.005 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 17:11:57.077 +05:30 [DBG] mvc found in database: true
2018-02-23 17:11:57.094 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:11:57.102 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:11:57.118 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:11:57.127 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:11:57.127 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 17:11:57.128 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "AQXKoAz3y9u5YCtqH74AeTQAaulaIBDg7kPlnGh1",
  "Nonce": "AQXKoAz3y9u5YCtqH74AeTQAaulaIBDg7kPlnGh1",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "AQXKoAz3y9u5YCtqH74AeTQAaulaIBDg7kPlnGh1",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "AQXKoAz3y9u5YCtqH74AeTQAaulaIBDg7kPlnGh1"
  }
}
2018-02-23 17:11:57.133 +05:30 [INF] Showing login: User is not authenticated
2018-02-23 17:11:57.165 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 17:11:57.232 +05:30 [DBG] mvc found in database: true
2018-02-23 17:11:57.244 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:11:57.253 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:11:57.271 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:11:57.281 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:11:57.282 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 17:11:57.365 +05:30 [DBG] mvc found in database: true
2018-02-23 17:11:59.710 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:12:09.737 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:12:19.746 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:12:29.762 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:12:39.773 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:12:49.780 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:12:59.792 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:13:09.802 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:13:19.825 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:13:29.827 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:13:39.834 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:13:49.844 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:13:59.859 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:14:09.868 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:14:19.883 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:14:29.900 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:14:39.916 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:14:49.930 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:14:59.943 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:15:09.950 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:15:19.963 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:15:29.977 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:15:40.013 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:15:50.036 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:16:00.050 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:16:10.073 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:16:20.079 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:16:30.106 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:16:40.116 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:16:50.140 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:17:00.153 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:17:10.167 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:17:20.181 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:17:30.193 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:17:40.214 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:17:50.229 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:18:00.254 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:18:10.273 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:18:20.284 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:18:30.297 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:18:40.314 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:18:50.328 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:19:00.343 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:19:10.359 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:19:20.379 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:19:30.389 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:19:40.406 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:19:50.416 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:20:00.431 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:20:10.449 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:20:20.466 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:20:30.486 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:20:40.501 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:20:50.513 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:21:00.530 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:21:10.546 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:21:20.555 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:21:30.563 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:21:40.581 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:21:50.595 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:22:00.603 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:22:10.605 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:22:20.612 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:22:30.622 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:22:40.635 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:22:50.657 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:23:00.664 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:23:10.682 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:23:20.695 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:23:30.716 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:23:40.731 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:23:50.749 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:24:00.765 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:24:10.785 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:24:20.790 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:24:30.797 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:24:40.844 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:24:50.851 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:25:02.940 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:25:12.959 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:25:22.970 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:25:32.981 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:25:42.993 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:25:52.999 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:26:03.009 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:26:13.019 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:26:23.021 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:26:33.036 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:26:43.052 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:26:53.073 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:27:03.090 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:27:13.101 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:27:23.123 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:27:33.143 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:27:43.156 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:27:53.169 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:28:03.185 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:28:13.202 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:28:23.209 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:28:33.223 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:28:43.240 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:28:53.250 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:29:03.272 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:29:13.286 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:29:23.296 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:29:33.301 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:29:43.309 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:29:53.311 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:30:03.317 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:30:13.334 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:30:23.341 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:30:33.350 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:30:43.354 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:30:53.369 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:31:03.383 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:31:13.405 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:31:23.421 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:31:33.425 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:31:43.435 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:31:53.446 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:32:03.462 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:32:13.470 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:32:23.470 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:32:33.490 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:32:43.522 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:32:53.550 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:33:03.562 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:33:13.587 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:33:23.640 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:33:33.672 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:33:43.686 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:33:53.708 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:34:03.735 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:34:13.746 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:34:23.756 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:34:33.777 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:34:43.788 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:34:53.800 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:35:03.817 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:35:13.841 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:35:23.857 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:35:33.875 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:35:43.902 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:35:53.913 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:36:03.927 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:36:13.951 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:36:23.971 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:36:33.986 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:36:44.023 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:36:54.046 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:37:04.056 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:37:14.068 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:37:24.082 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:37:34.086 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:37:44.094 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:37:54.123 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:38:04.139 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:38:14.160 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:38:24.171 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:38:34.188 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:38:44.206 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:38:54.222 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:39:04.244 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:39:14.267 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:39:24.275 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:39:34.286 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:39:44.285 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:39:54.286 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:40:04.294 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:40:14.313 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:40:24.330 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:40:34.345 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:40:44.365 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:40:54.379 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:41:04.402 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:41:14.411 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:41:24.425 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:41:34.432 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:41:44.455 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:41:54.474 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:42:04.488 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:42:14.503 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:42:24.516 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:42:34.531 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:42:44.565 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:42:54.587 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:43:04.603 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:43:14.617 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:43:24.627 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:43:34.645 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:43:44.666 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:43:54.687 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:44:04.705 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:44:14.713 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:44:24.725 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:44:34.728 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:44:44.732 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:44:54.736 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:45:04.749 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:45:14.770 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:45:24.770 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:45:34.795 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:45:44.796 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:45:54.829 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:46:04.845 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:46:14.847 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:46:24.866 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:46:34.871 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:46:44.885 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:46:54.903 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:47:05.098 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:47:15.152 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:47:25.174 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:47:35.202 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:47:45.216 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:47:55.224 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:48:05.233 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:48:15.244 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:48:25.256 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:48:35.268 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:48:45.286 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:48:55.294 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:58:23.733 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-23 17:58:23.778 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-23 17:58:23.778 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-23 17:58:23.779 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-23 17:58:23.779 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-23 17:58:24.002 +05:30 [DBG] Starting token cleanup
2018-02-23 17:58:24.471 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:58:24.512 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:58:29.005 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:58:29.012 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:58:34.490 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:58:43.915 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 17:58:44.487 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:58:44.488 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:58:44.496 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 17:58:44.519 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 17:58:44.520 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 17:58:44.560 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:58:44.569 +05:30 [DBG] Start discovery request
2018-02-23 17:58:45.538 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 17:58:45.685 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 17:58:45.699 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:58:45.699 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:58:45.702 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 17:58:45.703 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 17:58:45.703 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 17:58:45.713 +05:30 [DBG] Start key discovery request
2018-02-23 17:58:45.801 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-23 17:58:45.808 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-23 17:58:45.808 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-23 17:58:45.818 +05:30 [DBG] Start authorize request
2018-02-23 17:58:45.833 +05:30 [DBG] No user present in authorize request
2018-02-23 17:58:45.840 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 17:58:46.482 +05:30 [DBG] mvc found in database: true
2018-02-23 17:58:46.551 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:58:46.609 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:58:46.631 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:58:46.635 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:58:46.645 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 17:58:46.666 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "Kqx5rtog1V7OeYBKPopEgs7KNunrLXgW2bLXrhL4",
  "Nonce": "Kqx5rtog1V7OeYBKPopEgs7KNunrLXgW2bLXrhL4",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "Kqx5rtog1V7OeYBKPopEgs7KNunrLXgW2bLXrhL4",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "Kqx5rtog1V7OeYBKPopEgs7KNunrLXgW2bLXrhL4"
  }
}
2018-02-23 17:58:46.682 +05:30 [INF] Showing login: User is not authenticated
2018-02-23 17:58:46.817 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 17:58:46.862 +05:30 [DBG] mvc found in database: true
2018-02-23 17:58:46.877 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:58:46.893 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:58:46.905 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:58:46.913 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:58:46.913 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 17:58:47.011 +05:30 [DBG] mvc found in database: true
2018-02-23 17:58:54.095 +05:30 [WRN] The LINQ expression 'where Equals([userbrand].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 17:58:54.106 +05:30 [WRN] The LINQ expression 'where Equals([userbrand].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 17:58:54.112 +05:30 [WRN] The LINQ expression 'where Equals([userbrand].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 17:58:54.118 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userbrand in {from User userbrand in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userbrand].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userbrand]?, "Id"), Object)})} on Property([userbrand.UserBrand], "UserId") equals Convert([_userbrand].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-23 17:58:54.121 +05:30 [WRN] The LINQ expression 'orderby [_userbrand].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-23 17:58:54.134 +05:30 [WRN] The LINQ expression 'where Equals([userbrand].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 17:58:54.139 +05:30 [WRN] The LINQ expression 'where Equals([userbrand].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-23 17:58:54.147 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userbrand in {from User userbrand in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userbrand].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userbrand]?, "Id"), Object)})} on Property([userbrand.UserRole], "UserId") equals Convert([_userbrand].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-23 17:58:54.151 +05:30 [WRN] The LINQ expression 'orderby [_userbrand].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-23 17:58:54.275 +05:30 [DBG] Augmenting SignInContext
2018-02-23 17:58:54.278 +05:30 [DBG] Adding idp claim with value: local
2018-02-23 17:58:54.278 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-23 17:58:54.292 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 17:58:54.319 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:58:54.323 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-23 17:58:54.326 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-23 17:58:54.328 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-23 17:58:54.328 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-23 17:58:54.340 +05:30 [DBG] Start authorize callback request
2018-02-23 17:58:54.346 +05:30 [DBG] User in authorize request: 1
2018-02-23 17:58:54.346 +05:30 [DBG] Start authorize request protocol validation
2018-02-23 17:58:54.392 +05:30 [DBG] mvc found in database: true
2018-02-23 17:58:54.400 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:58:54.406 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:58:54.414 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-23 17:58:54.418 +05:30 [DBG] Found [] API scopes in database
2018-02-23 17:58:54.418 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-23 17:58:54.419 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "Kqx5rtog1V7OeYBKPopEgs7KNunrLXgW2bLXrhL4",
  "Nonce": "Kqx5rtog1V7OeYBKPopEgs7KNunrLXgW2bLXrhL4",
  "SessionId": "5c0ad2f403b16bc266e69fdcddca682d",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "Kqx5rtog1V7OeYBKPopEgs7KNunrLXgW2bLXrhL4",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "Kqx5rtog1V7OeYBKPopEgs7KNunrLXgW2bLXrhL4"
  }
}
2018-02-23 17:58:54.496 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-23 17:58:54.506 +05:30 [DBG] Creating Implicit Flow response.
2018-02-23 17:58:54.521 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-23 17:58:54.522 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-23 17:58:56.079 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:58:57.440 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-23 17:58:57.551 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-23 17:58:59.712 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-23 17:58:59.732 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "Kqx5rtog1V7OeYBKPopEgs7KNunrLXgW2bLXrhL4",
  "Scope": "openid profile"
}
2018-02-23 17:58:59.763 +05:30 [DBG] Augmenting SignInContext
2018-02-23 17:58:59.764 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-23 17:59:01.643 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-23 17:59:01.653 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:59:01.654 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:59:01.659 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-23 17:59:01.659 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-23 17:59:01.659 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-23 17:59:01.666 +05:30 [DBG] Start discovery request
2018-02-23 17:59:01.766 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-23 17:59:02.426 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-23 17:59:02.479 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-23 17:59:02.479 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-23 17:59:02.496 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-23 17:59:02.497 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-23 17:59:02.497 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-23 17:59:02.535 +05:30 [DBG] Start key discovery request
2018-02-23 17:59:06.107 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:59:16.112 +05:30 [INF] Clearing 0 tokens
2018-02-23 17:59:26.130 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:48:39.245 +05:30 [DBG] Using idsrv as default scheme for authentication
2018-02-26 12:48:39.282 +05:30 [DBG] Using idsrv as default scheme for sign-in
2018-02-26 12:48:39.282 +05:30 [DBG] Using idsrv as default scheme for sign-out
2018-02-26 12:48:39.283 +05:30 [DBG] Using idsrv as default scheme for challenge
2018-02-26 12:48:39.283 +05:30 [DBG] Using idsrv as default scheme for forbid
2018-02-26 12:48:39.533 +05:30 [DBG] Starting token cleanup
2018-02-26 12:48:39.758 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:39.785 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:43.621 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:43.624 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:43.721 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:43.723 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:43.781 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:43.784 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:43.988 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:43.990 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:44.075 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:44.088 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:44.144 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:44.151 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:44.176 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:44.179 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:48:55.574 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-26 12:49:04.910 +05:30 [ERR] An error occurred using the connection to database 'Globalbrrf' on server '192.168.38.30'.
System.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: SSL Provider, error: 0 - The wait operation timed out.) ---> System.ComponentModel.Win32Exception (0x80004005): The wait operation timed out
   at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling)
   at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
ClientConnectionId:9dd9d235-5623-4865-8919-6cbd04bc6c3d
Error Number:258,State:0,Class:20
2018-02-26 12:49:04.910 +05:30 [ERR] An error occurred using the connection to database 'Globalbrrf' on server '192.168.38.30'.
System.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: SSL Provider, error: 0 - The wait operation timed out.) ---> System.ComponentModel.Win32Exception (0x80004005): The wait operation timed out
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
ClientConnectionId:9dd9d235-5623-4865-8919-6cbd04bc6c3d
Error Number:258,State:0,Class:20
2018-02-26 12:49:05.053 +05:30 [ERR] An exception occurred in the database while iterating the results of a query for context type 'BRRF.IdentityServer.Repository.DbContexts.ConfigurationDbContext'.
System.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: SSL Provider, error: 0 - The wait operation timed out.) ---> System.ComponentModel.Win32Exception (0x80004005): The wait operation timed out
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(Boolean buffer)
   at Microsoft.EntityFrameworkCore.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
ClientConnectionId:9dd9d235-5623-4865-8919-6cbd04bc6c3d
Error Number:258,State:0,Class:20
System.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: SSL Provider, error: 0 - The wait operation timed out.) ---> System.ComponentModel.Win32Exception (0x80004005): The wait operation timed out
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(Boolean buffer)
   at Microsoft.EntityFrameworkCore.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
ClientConnectionId:9dd9d235-5623-4865-8919-6cbd04bc6c3d
Error Number:258,State:0,Class:20
2018-02-26 12:49:05.055 +05:30 [ERR] An exception occurred in the database while iterating the results of a query for context type 'BRRF.IdentityServer.Repository.DbContexts.PersistedGrantDbContext'.
System.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: SSL Provider, error: 0 - The wait operation timed out.) ---> System.ComponentModel.Win32Exception (0x80004005): The wait operation timed out
   at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling)
   at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(Boolean buffer)
   at Microsoft.EntityFrameworkCore.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.<_TrackEntities>d__17`2.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
ClientConnectionId:9dd9d235-5623-4865-8919-6cbd04bc6c3d
Error Number:258,State:0,Class:20
System.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: SSL Provider, error: 0 - The wait operation timed out.) ---> System.ComponentModel.Win32Exception (0x80004005): The wait operation timed out
   at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling)
   at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(Boolean buffer)
   at Microsoft.EntityFrameworkCore.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.<_TrackEntities>d__17`2.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
ClientConnectionId:9dd9d235-5623-4865-8919-6cbd04bc6c3d
Error Number:258,State:0,Class:20
2018-02-26 12:49:23.251 +05:30 [ERR] An unhandled exception has occurred while executing the request
System.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: SSL Provider, error: 0 - The wait operation timed out.) ---> System.ComponentModel.Win32Exception (0x80004005): The wait operation timed out
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(Boolean buffer)
   at Microsoft.EntityFrameworkCore.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Collections.Generic.List`1.AddEnumerable(IEnumerable`1 enumerable)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at BRRF.IdentityServer.Repository.Services.CorsPolicyService.IsOriginAllowedAsync(String origin) in D:\Projects\SesatSolutions\BRRF\Brrf-Security\BRRF.IdentityServer.Repository\Services\CorsPolicyService.cs:line 47
   at IdentityServer4.Hosting.CorsPolicyProvider.<ProcessAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\CorsPolicyProvider.cs:line 56
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
ClientConnectionId:9dd9d235-5623-4865-8919-6cbd04bc6c3d
Error Number:258,State:0,Class:20
2018-02-26 12:49:23.323 +05:30 [ERR] Exception clearing tokens: A connection was successfully established with the server, but then an error occurred during the pre-login handshake. (provider: SSL Provider, error: 0 - The wait operation timed out.)
2018-02-26 12:49:33.959 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:49:43.087 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-26 12:49:43.215 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-26 12:49:43.216 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-26 12:49:43.305 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-26 12:49:43.321 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-26 12:49:43.322 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-26 12:49:43.330 +05:30 [DBG] Start discovery request
2018-02-26 12:49:44.762 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:49:45.252 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-26 12:49:45.407 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-26 12:49:45.688 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-26 12:49:45.688 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-26 12:49:45.691 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-26 12:49:45.691 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-26 12:49:45.692 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-26 12:49:45.699 +05:30 [DBG] Start key discovery request
2018-02-26 12:49:45.809 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:49:45.814 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:49:45.817 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-26 12:49:45.824 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-26 12:49:45.825 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-26 12:49:45.835 +05:30 [DBG] Start authorize request
2018-02-26 12:49:45.851 +05:30 [DBG] User in authorize request: 1
2018-02-26 12:49:45.859 +05:30 [DBG] Start authorize request protocol validation
2018-02-26 12:49:48.632 +05:30 [DBG] mvc found in database: true
2018-02-26 12:49:48.714 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-26 12:49:48.790 +05:30 [DBG] Found [] API scopes in database
2018-02-26 12:49:48.864 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-26 12:49:48.972 +05:30 [DBG] Found [] API scopes in database
2018-02-26 12:49:48.982 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-26 12:49:49.001 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "m15Yqu2pqmaUUsUx55M1eg5qF7OIW3hbaYbfS9Or",
  "Nonce": "m15Yqu2pqmaUUsUx55M1eg5qF7OIW3hbaYbfS9Or",
  "SessionId": "5c0ad2f403b16bc266e69fdcddca682d",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "m15Yqu2pqmaUUsUx55M1eg5qF7OIW3hbaYbfS9Or",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "m15Yqu2pqmaUUsUx55M1eg5qF7OIW3hbaYbfS9Or"
  }
}
2018-02-26 12:49:49.691 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-26 12:49:49.704 +05:30 [DBG] Creating Implicit Flow response.
2018-02-26 12:49:49.721 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-26 12:49:49.721 +05:30 [DBG] Getting claims for access token for subject: 1
2018-02-26 12:49:52.871 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-26 12:49:52.970 +05:30 [DBG] Getting claims for identity token for subject: 1 and client: mvc
2018-02-26 12:49:55.038 +05:30 [DBG] Claim types from profile service that were filtered: ["sub"]
2018-02-26 12:49:55.066 +05:30 [INF] Authorize endpoint response
{
  "SubjectId": "1",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:4200/",
  "State": "m15Yqu2pqmaUUsUx55M1eg5qF7OIW3hbaYbfS9Or",
  "Scope": "openid profile"
}
2018-02-26 12:49:55.177 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:49:56.805 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-26 12:49:56.883 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-26 12:49:56.883 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-26 12:49:56.895 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-26 12:49:56.898 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-26 12:49:56.898 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-26 12:49:56.916 +05:30 [DBG] Start discovery request
2018-02-26 12:49:57.735 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-26 12:49:58.335 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-26 12:49:58.364 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-26 12:49:58.364 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-26 12:49:58.372 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-26 12:49:58.372 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-26 12:49:58.372 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-26 12:49:58.381 +05:30 [DBG] Start key discovery request
2018-02-26 12:50:05.257 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:50:12.293 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-26 12:50:13.278 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-26 12:50:13.278 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-26 12:50:13.282 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-26 12:50:13.282 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-26 12:50:13.282 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-26 12:50:13.288 +05:30 [DBG] Start discovery request
2018-02-26 12:50:14.543 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-26 12:50:14.556 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-26 12:50:14.766 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-26 12:50:14.766 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-26 12:50:14.768 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-26 12:50:14.768 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-26 12:50:14.769 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-26 12:50:14.770 +05:30 [DBG] Start key discovery request
2018-02-26 12:50:14.819 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-26 12:50:14.819 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-26 12:50:14.819 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-26 12:50:14.835 +05:30 [DBG] Start authorize request
2018-02-26 12:50:14.836 +05:30 [DBG] No user present in authorize request
2018-02-26 12:50:14.836 +05:30 [DBG] Start authorize request protocol validation
2018-02-26 12:50:15.919 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:50:18.243 +05:30 [DBG] mvc found in database: true
2018-02-26 12:50:20.420 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-26 12:50:20.495 +05:30 [DBG] Found [] API scopes in database
2018-02-26 12:50:20.546 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-26 12:50:20.575 +05:30 [DBG] Found [] API scopes in database
2018-02-26 12:50:20.575 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-26 12:50:20.575 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "Sp3u56sxYsdhDLwB89N7TkyejxM6qHVnx5u4vZ7t",
  "Nonce": "Sp3u56sxYsdhDLwB89N7TkyejxM6qHVnx5u4vZ7t",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "Sp3u56sxYsdhDLwB89N7TkyejxM6qHVnx5u4vZ7t",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "Sp3u56sxYsdhDLwB89N7TkyejxM6qHVnx5u4vZ7t"
  }
}
2018-02-26 12:50:20.579 +05:30 [INF] Showing login: User is not authenticated
2018-02-26 12:50:20.730 +05:30 [DBG] Start authorize request protocol validation
2018-02-26 12:50:26.030 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:50:28.398 +05:30 [DBG] mvc found in database: true
2018-02-26 12:50:28.535 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-26 12:50:28.549 +05:30 [DBG] Found [] API scopes in database
2018-02-26 12:50:28.585 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-26 12:50:28.592 +05:30 [DBG] Found [] API scopes in database
2018-02-26 12:50:28.592 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-26 12:50:31.131 +05:30 [DBG] mvc found in database: true
2018-02-26 12:50:36.205 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:50:47.580 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:51:00.614 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:51:10.975 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:51:22.657 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:51:32.962 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:51:43.140 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:51:53.511 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:52:03.591 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:52:13.614 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:52:23.854 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:52:34.145 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:52:44.177 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:52:55.125 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:53:06.045 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:53:18.550 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:53:28.994 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:53:39.264 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:53:49.765 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:54:01.482 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:54:11.647 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:54:21.748 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:54:31.807 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:54:41.996 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:54:52.017 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:55:02.358 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:55:12.491 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:55:22.507 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:55:32.519 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:55:42.536 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:55:52.565 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:56:03.505 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:56:13.615 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:56:23.652 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:56:33.664 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:56:43.681 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:56:44.916 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-02-26 12:56:45.077 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-26 12:56:45.077 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-26 12:56:45.080 +05:30 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-02-26 12:56:45.081 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-02-26 12:56:45.081 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-02-26 12:56:45.084 +05:30 [DBG] Start discovery request
2018-02-26 12:56:45.218 +05:30 [DBG] Found ["openid","profile","custom.profile","BrrfWebApi"] as all scopes in database
2018-02-26 12:56:45.451 +05:30 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-02-26 12:56:45.591 +05:30 [DBG] Origin http://localhost:4200 is allowed: true
2018-02-26 12:56:45.591 +05:30 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-02-26 12:56:45.594 +05:30 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-02-26 12:56:45.594 +05:30 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-02-26 12:56:45.594 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-02-26 12:56:45.599 +05:30 [DBG] Start key discovery request
2018-02-26 12:56:45.651 +05:30 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-02-26 12:56:45.651 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-02-26 12:56:45.651 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-02-26 12:56:45.655 +05:30 [DBG] Start authorize request
2018-02-26 12:56:45.655 +05:30 [DBG] No user present in authorize request
2018-02-26 12:56:45.655 +05:30 [DBG] Start authorize request protocol validation
2018-02-26 12:56:46.849 +05:30 [DBG] mvc found in database: true
2018-02-26 12:56:47.125 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-26 12:56:47.439 +05:30 [DBG] Found [] API scopes in database
2018-02-26 12:56:47.642 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-26 12:56:47.706 +05:30 [DBG] Found [] API scopes in database
2018-02-26 12:56:47.706 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-26 12:56:47.706 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "ja03aRB3apoQEKgmxQ7x2WsggZDZMYYlfyZ0j8mY",
  "Nonce": "ja03aRB3apoQEKgmxQ7x2WsggZDZMYYlfyZ0j8mY",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "ja03aRB3apoQEKgmxQ7x2WsggZDZMYYlfyZ0j8mY",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "ja03aRB3apoQEKgmxQ7x2WsggZDZMYYlfyZ0j8mY"
  }
}
2018-02-26 12:56:47.708 +05:30 [INF] Showing login: User is not authenticated
2018-02-26 12:56:47.731 +05:30 [DBG] Start authorize request protocol validation
2018-02-26 12:56:48.398 +05:30 [DBG] mvc found in database: true
2018-02-26 12:56:48.427 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-26 12:56:48.446 +05:30 [DBG] Found [] API scopes in database
2018-02-26 12:56:48.475 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-26 12:56:48.493 +05:30 [DBG] Found [] API scopes in database
2018-02-26 12:56:48.493 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-26 12:56:49.012 +05:30 [DBG] mvc found in database: true
2018-02-26 12:56:53.718 +05:30 [INF] Clearing 0 tokens
2018-02-26 12:56:58.272 +05:30 [WRN] The LINQ expression 'where Equals([userbrand].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-26 12:56:58.280 +05:30 [WRN] The LINQ expression 'where Equals([userbrand].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-26 12:56:58.284 +05:30 [WRN] The LINQ expression 'where Equals([userbrand].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-26 12:56:58.288 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userbrand in {from User userbrand in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userbrand].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userbrand]?, "Id"), Object)})} on Property([userbrand.UserBrand], "UserId") equals Convert([_userbrand].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-26 12:56:58.291 +05:30 [WRN] The LINQ expression 'orderby [_userbrand].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-26 12:56:58.299 +05:30 [WRN] The LINQ expression 'where Equals([userbrand].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-26 12:56:58.301 +05:30 [WRN] The LINQ expression 'where Equals([userbrand].UserName, __username_0)' could not be translated and will be evaluated locally.
2018-02-26 12:56:58.304 +05:30 [WRN] The LINQ expression 'join AnonymousObject _userbrand in {from User userbrand in value(Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[BRRF.IdentityServer.Repository.Entities.User]) where Equals([userbrand].UserName, __username_0) select new AnonymousObject(new [] {Convert(EF.Property(?[userbrand]?, "Id"), Object)})} on Property([userbrand.UserRole], "UserId") equals Convert([_userbrand].GetValue(0), Nullable`1)' could not be translated and will be evaluated locally.
2018-02-26 12:56:58.307 +05:30 [WRN] The LINQ expression 'orderby [_userbrand].GetValue(0) asc' could not be translated and will be evaluated locally.
2018-02-26 12:56:58.459 +05:30 [DBG] Augmenting SignInContext
2018-02-26 12:56:58.463 +05:30 [DBG] Adding idp claim with value: local
2018-02-26 12:56:58.463 +05:30 [DBG] Adding amr claim with value: pwd
2018-02-26 12:56:58.474 +05:30 [INF] AuthenticationScheme: idsrv signed in.
2018-02-26 12:56:58.499 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:56:58.502 +05:30 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2018-02-26 12:56:58.506 +05:30 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-02-26 12:56:58.507 +05:30 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-02-26 12:56:58.508 +05:30 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-02-26 12:56:58.517 +05:30 [DBG] Start authorize callback request
2018-02-26 12:56:58.522 +05:30 [DBG] User in authorize request: 1
2018-02-26 12:56:58.522 +05:30 [DBG] Start authorize request protocol validation
2018-02-26 12:57:01.014 +05:30 [DBG] mvc found in database: true
2018-02-26 12:57:01.974 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-26 12:57:01.986 +05:30 [DBG] Found [] API scopes in database
2018-02-26 12:57:02.010 +05:30 [DBG] Found ["openid","profile"] identity scopes in database
2018-02-26 12:57:02.016 +05:30 [DBG] Found [] API scopes in database
2018-02-26 12:57:02.016 +05:30 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-02-26 12:57:02.016 +05:30 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:4200/",
  "AllowedRedirectUris": [
    "http://localhost:4200/",
    "http://localhost:4401/",
    "http://brrfsam.sesatsolutions.loc",
    "http://brrfmid.sesatsolutions.loc"
  ],
  "SubjectId": "1",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile",
  "State": "Sp3u56sxYsdhDLwB89N7TkyejxM6qHVnx5u4vZ7t",
  "Nonce": "Sp3u56sxYsdhDLwB89N7TkyejxM6qHVnx5u4vZ7t",
  "SessionId": "0845143afd972eb93f1195a6c75582a9",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "mvc",
    "state": "Sp3u56sxYsdhDLwB89N7TkyejxM6qHVnx5u4vZ7t",
    "redirect_uri": "http://localhost:4200/",
    "scope": "openid profile",
    "nonce": "Sp3u56sxYsdhDLwB89N7TkyejxM6qHVnx5u4vZ7t"
  }
}
2018-02-26 12:57:03.580 +05:30 [DBG] Client is configured to not require consent, no consent is required
2018-02-26 12:57:03.580 +05:30 [DBG] Creating Implicit Flow response.
2018-02-26 12:57:03.581 +05:30 [DBG] Getting claims for access token for client: mvc
2018-02-26 12:57:03.581 +05:30 [DBG] Getting claims for access token for subject: 1
